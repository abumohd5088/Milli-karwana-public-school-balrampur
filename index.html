<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Springfield India School</title>
  <link rel="stylesheet" href="css/ultra-pro.css" />
  <link rel="icon" href="images/favicon.ico" />
</head>
<body class="login-body">
  <div class="login-container">
    <img src="images/logo.png" alt="Logo" class="logo" />
    <h1>Springfield India</h1>
    <p>Choose your role to continue</p>

    <select id="role-select">
      <option value="student">Student</option>
      <option value="teacher">Teacher</option>
      <option value="parent">Parent</option>
      <option value="admin">Admin</option>
    </select>

    <div id="student-fields">
      <input type="text" id="student-name" placeholder="Your Name" />
      <select id="student-class">
        <option value="">Select Class</option>
        <script>for(let i=1;i<=12;i++)document.write(`<option value="${i}">Class ${i}</option>`);</script>
      </select>
    </div>

    <div id="teacher-fields" style="display:none;">
      <input type="text" id="teacher-id" placeholder="Teacher ID" />
      <input type="text" id="teacher-name" placeholder="Full Name" />
    </div>

    <div id="parent-fields" style="display:none;">
      <input type="text" id="parent-child-name" placeholder="Child's Name" />
      <select id="parent-child-class">
        <option value="">Child's Class</option>
        <script>for(let i=1;i<=12;i++)document.write(`<option value="${i}">Class ${i}</option>`);</script>
      </select>
    </div>

    <div id="admin-fields" style="display:none;">
      <input type="password" id="admin-pass" placeholder="Admin Password" />
    </div>

    <!-- Biometric Sim -->
    <button id="bio-btn" class="btn-outline">üîê Use Biometric Login</button>

    <button id="next-btn" class="btn-primary">Sign In</button>

    <!-- Hidden Debug Link -->
    <a href="admin.html" id="debug-link" style="display:none; font-size:0.8rem; margin-top:10px;">üîß Admin Panel</a>
  </div>

  <script src="js/utils.js"></script>
  <script>
    const roleFields = {
      student: ['student-fields'],
      teacher: ['teacher-fields'],
      parent: ['parent-fields'],
      admin: ['admin-fields']
    };

    document.getElementById('role-select').onchange = function () {
      Object.keys(roleFields).forEach(k => document.getElementById(k + '-fields').style.display = 'none');
      const fields = roleFields[this.value];
      fields.forEach(f => document.getElementById(f).style.display = 'block');
    };

    // Show debug link on long press
    let pressTimer;
    document.body.addEventListener('mousedown', () => {
      pressTimer = setTimeout(() => {
        document.getElementById('debug-link').style.display = 'block';
        setTimeout(() => document.getElementById('debug-link').style.display = 'none', 3000);
      }, 2000);
    });
    document.body.addEventListener('mouseup', () => clearTimeout(press););

    document.getElementById('bio-btn').onclick = () => alert("‚úÖ Simulated biometric login successful!");

    document.getElementById('next-btn').onclick = function () {
      const role = document.getElementById('role-select').value;

      if (role === 'student') {
        const name = document.getElementById('student-name').value.trim();
        const cls = document.getElementById('student-class').value;
        if (!name || !cls) return alert("Enter name and class!");
        localStorage.setItem('user', JSON.stringify({ role, name, class: cls }));
      }

      if (role === 'teacher') {
        const id = document.getElementById('teacher-id').value;
        const name = document.getElementById('teacher-name').value;
        if (!id || !name) return alert("Enter ID and name!");
        localStorage.setItem('user', JSON.stringify({ role, id, name }));
      }

      if (role === 'parent') {
        const child = document.getElementById('parent-child-name').value;
        const cls = document.getElementById('parent-child-class').value;
        if (!child || !cls) return alert("Enter child info!");
        localStorage.setItem('user', JSON.stringify({ role, child, class: cls }));
      }

      if (role === 'admin') {
        if (document.getElementById('admin-pass').value !== 'Abutalha') {
          return alert("‚ùå Wrong password!");
        }
        localStorage.setItem('user', JSON.stringify({ role: 'admin' }));
      }

      // Redirect
      const pages = { student: 'dashboard.html', teacher: 'teacher.html', parent: 'parent.html', admin: 'admin.html' };
      window.location.href = pages[role];
    };
  </script>
</body>
</html>
