<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>Kider Dashboard | School Web</title>
<meta name="description" content="Your colourful, mobile-first school dashboard">
<meta name="theme-color" content="#ff6b81">
<link rel="manifest" href="data:application/json,{"name":"Kider Dashboard","short_name":"Kider","icons":[{"src":"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Ctext y='50%25' x='50%25' dominant-baseline='middle' text-anchor='middle' font-size='300'%3Eüéí%3C/text%3E%3C/svg%3E","sizes":"512x512","type":"image/svg+xml"}],"start_url":"/dashboard.html","display":"standalone","background_color":"#ff6b81","theme_color":"#ff6b81"}">
<style>
:root{--pink:#ff6b81;--light:#fff5f7;--dark:#333;--radius:12px;--shadow:0 3px 10px rgba(0,0,0,.15);}
.dark{--light:#121212;--dark:#f1f3f5;}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;}
body{background:var(--light);color:var(--dark);line-height:1.6;transition:.3s}
nav{display:flex;justify-content:space-between;align-items:center;background:var(--pink);color:#fff;padding:12px 15px;position:sticky;top:0;z-index:1000}
.hamburger{background:none;border:none;color:#fff;font-size:1.6em;cursor:pointer}
.side-panel{position:fixed;top:0;right:-280px;width:280px;height:100%;background:#fff;box-shadow:var(--shadow);transition:right .3s;z-index:1001;padding:25px;color:var(--dark)}
.side-panel.open{right:0}
.overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.4);display:none;z-index:999}
.overlay.open{display:block}
.side-panel ul{list-style:none;margin-top:20px}
.side-panel li{margin:15px 0}
.side-panel a{color:var(--dark);text-decoration:none;font-weight:600}
.container{padding:15px;max-width:700px;margin:auto}
.card{background:#fff;border-radius:var(--radius);box-shadow:var(--shadow);padding:20px;margin-bottom:20px;text-align:center}
.card img{width:100%;border-radius:var(--radius);margin-bottom:10px}
.btn{background:var(--pink);color:#fff;border:none;padding:12px 25px;border-radius:var(--radius);cursor:pointer;font-weight:600}
.btn:hover{background:#ff4f67}
.hw-list{list-style:none}
.hw-list li{padding:12px;border-bottom:1px solid #ddd;display:flex;justify-content:space-between;align-items:center}
.hw-list li:last-child{border:none}
.chatBox{min-height:200px;max-height:300px;overflow-y:auto;border:1px solid #ccc;border-radius:var(--radius);padding:10px;background:#fff;color:#000;font-size:.9em;margin-bottom:10px}
.chatInput{display:flex;gap:6px}
.chatInput input{flex:1;padding:10px;border:1px solid #ccc;border-radius:var(--radius)}
.chatInput button{padding:10px 15px;background:var(--pink);color:#fff;border:none;border-radius:var(--radius);font-weight:bold}
.fab{position:fixed;bottom:20px;right:20px;background:var(--pink);color:#fff;border:none;border-radius:50%;width:56px;height:56px;font-size:1.5em;box-shadow:var(--shadow);cursor:pointer;z-index:1002}
.notify{position:fixed;top:15px;right:15px;background:#ffc107;color:#000;padding:12px;border-radius:var(--radius);display:none;z-index:1003}
footer{background:var(--dark);color:#fff;padding:20px;text-align:center}
@media(max-width:600px){.hero h1{font-size:2em}}
</style>
</head>
<body>

<!-- NAVBAR -->
<nav>
  <span>üéí Kider Dashboard ‚Äì Class <span id="clsSpan"></span></span>
  <button class="hamburger" onclick="toggleMenu()">‚ò∞</button>
</nav>

<!-- OVERLAY + SIDE PANEL -->
<div class="overlay" id="overlay" onclick="toggleMenu()"></div>
<div class="side-panel" id="sidePanel">
  <h3>Menu</h3>
  <ul>
    <li><a href="#" onclick="printHW()">üñ®Ô∏è Print Homework</a></li>
    <li><a href="#" onclick="sharePage()">üì§ Share</a></li>
    <li><a href="#" onclick="toggleDark()">üåó Dark</a></li>
    <li><a href="#" onclick="installPWA()">üì≤ Install</a></li>
    <li><a href="#" onclick="openAdmin()">üîê Admin</a></li>
    <li><a href="#" onclick="logout()">üö™ Logout</a></li>
  </ul>
</div>

<!-- NOTIFICATION -->
<div id="notify" class="notify"></div>

<!-- WELCOME -->
<div class="container">
  <div class="card">
    <h2>Welcome back, <span id="nameSpan"></span> üëã</h2>
  </div>

  <!-- CLASS HOMEWORK -->
  <div class="card">
    <h2>üìö Today's Homework</h2>
    <ul id="hwList" class="hw-list"></ul>
    <button class="btn" onclick="addHW()">Add New</button>
  </div>

  <!-- AI HELPER -->
  <div class="card">
    <h2>ü§ñ AI Homework Helper</h2>
    <div class="chatBox" id="chatBox"></div>
    <div class="chatInput">
      <input id="chatIn" placeholder="Ask about homework‚Ä¶"/>
      <button onclick="askAI()">Send</button>
    </div>
  </div>

  <!-- FACILITIES (matching Kider style) -->
  <div class="card">
    <h2>School Facilities</h2>
    <div class="grid">
      <div class="card"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='200'%3E%3Crect width='100%25' height='100%25' fill='%23ff6b81'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-size='20' fill='%23fff'%3Eüöå%3C/text%3E%3C/svg%3E" alt="Bus"><h4>School Bus</h4></div>
      <div class="card"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='200'%3E%3Crect width='100%25' height='100%25' fill='%23a18cd1'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-size='20' fill='%23fff'%3Eüéæ%3C/text%3E%3C/svg%3E" alt="Playground"><h4>Playground</h4></div>
      <div class="card"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='200'%3E%3Crect width='100%25' height='100%25' fill='%23fad961'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-size='20' fill='%23fff'%3Eü•ó%3C/text%3E%3C/svg%3E" alt="Canteen"><h4>Healthy Canteen</h4></div>
      <div class="card"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='200'%3E%3Crect width='100%25' height='100%25' fill='%2356ccf2'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-size='20' fill='%23fff'%3Eüß†%3C/text%3E%3C/svg%3E" alt="Learning"><h4>Positive Learning</h4></div>
    </div>
  </div>

  <!-- OFFLINE BANNER -->
  <div id="offlineBanner" class="card hidden">
    ‚ö†Ô∏è You are offline ‚Äì data cached.
  </div>
</div>

<!-- FLOATING ACTION BUTTON -->
<button class="fab" onclick="scrollToTop()">‚Üë</button>

<footer>¬© 2025 Kider Dashboard ‚Äì Unlimited Features</footer>

<script>
/* ---------- CONFIG ---------- */
const API_KEY = "AIzaSyCdzFBQ1KVgBfmmjSgHJJwcuLbqne9VjUs";
const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`;

/* ---------- AUTH ---------- */
if(!localStorage.getItem('name')) location.href='index.html';
const cls = localStorage.getItem('cls');
const name = localStorage.getItem('name');
document.getElementById('clsSpan').innerText = cls;
document.getElementById('nameSpan').innerText = name;

/* ---------- MENU ---------- */
function toggleMenu(){
  const panel=document.getElementById('sidePanel');
  const overlay=document.getElementById('overlay');
  panel.classList.toggle('open');
  overlay.classList.toggle('open');
}

/* ---------- DARK MODE ---------- */
function toggleDark(){
  document.body.classList.toggle('dark');
  localStorage.setItem('dark',document.body.classList.contains('dark'));
  showToast('Theme updated');
}
if(localStorage.getItem('dark')==='true') document.body.classList.add('dark');

/* ---------- NOTIFICATION ---------- */
function showToast(msg){
  const el=document.getElementById('notify');
  el.innerText=msg;
  el.style.display='block';
  setTimeout(()=>el.style.display='none',2000);
}

/* ---------- HOMEWORK DB ---------- */
const homeworkDB={
 "1":["Math ‚Äì Count üê£ 1-50","English ‚Äì A-Z ‚úçÔ∏è","Art ‚Äì Colour üé® apple"],
 "2":["Math ‚Äì Tables üî¢ 2-5","EVS ‚Äì My Family üë®‚Äçüë©‚Äçüëß‚Äçüë¶","Hindi ‚Äì Varnamala üî°"],
 "3":["Math ‚Äì Addition ‚ûï 3-digit","English ‚Äì Story üìñ","Science ‚Äì Body üßç‚Äç‚ôÇÔ∏è parts"],
 "4":["Math ‚Äì Long division ‚ûó","Science ‚Äì Plant üå± diagram","SST ‚Äì Our üåç country"],
 "5":["Math ‚Äì Fraction ü•ß basics","English ‚Äì Paragraph ‚úçÔ∏è","EVS ‚Äì Water üíß cycle"],
 "6":["Math ‚Äì Algebra üßÆ intro","Science ‚Äì Light üí°","History ‚Äì Ancient üè∫ India"],
 "7":["Math ‚Äì Simple equations ü§ì","History ‚Äì Delhi üïå Sultanate","Geography ‚Äì Atmosphere üå™Ô∏è"],
 "8":["Math ‚Äì Rational üî¢ numbers","Physics ‚Äì Force üí™ & pressure","Chemistry ‚Äì Metals ‚öôÔ∏è"],
 "9":["Math ‚Äì Polynomials üß©","Chemistry ‚Äì Matter ‚öõÔ∏è","Physics ‚Äì Motion üèÉ‚Äç‚ôÇÔ∏è"],
 "10":["Math ‚Äì Quadratic ‚ÄºÔ∏è equations","Physics ‚Äì Electricity ‚ö°","Chemistry ‚Äì Acids üçã"],
 "11":["Math ‚Äì Sets üß©","Chemistry ‚Äì Mole üêÄ concept","Physics ‚Äì Units üìè"],
 "12":["Math ‚Äì Relations üîó","Physics ‚Äì Electrostatics ‚ö°","Chemistry ‚Äì Solutions üß™"]
};
document.getElementById('hwList').innerHTML=homeworkDB[cls].map(hw=>`<li>${hw}</li>`).join('');

function addHW(){
 const task=prompt('Enter homework:');
 if(task){
   const li=document.createElement('li');
   li.innerText=task;
   document.getElementById('hwList').appendChild(li);
   showToast('Added ‚úÖ');
 }
}

/* ---------- AI (HOMEWORK ONLY + EMOJIS) ---------- */
async function askAI(){
 const msg=document.getElementById('chatIn').value.trim();
 if(!msg) return;
 const box=document.getElementById('chatBox');
 box.innerHTML+=`<div><b>You:</b> ${msg}</div>`;
 document.getElementById('chatIn').value='';
 const prompt=`You are the school AI for class ${cls}. Answer strictly about today‚Äôs homework or school info. Question: ${msg}`;
 try{
   const res=await fetch(API_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({contents:[{parts:[{text:prompt}]}]})});
   const data=await res.json();
   const reply=data.candidates?.[0]?.content?.parts?.[0]?.text||`üìö Today's homework for class ${cls}:\n`+homeworkDB[cls].join('\n');
   box.innerHTML+=`<div><b>AI:</b> ${reply}</div>`;
   box.scrollTop=box.scrollHeight;
 }catch(e){
   box.innerHTML+=`<div><b>Offline ü§ñ:</b> ${homeworkDB[cls].join(' | ')}</div>`;
 }
}

/* ---------- DOWNLOAD PDF ---------- */
function downloadHW(){
 const text=`Class ${cls} Homework\n`+homeworkDB[cls].join('\n');
 const blob=new Blob([text],{type:'application/pdf'});
 const url=URL.createObjectURL(blob);
 const a=document.createElement('a');
 a.href=url;
 a.download=`Class${cls}_Homework.pdf`;
 a.click();
 URL.revokeObjectURL(url);
 showToast('PDF downloaded üéâ');
}

/* ---------- REMINDER ---------- */
function remindHW(){
 if(!('Notification' in window)){showToast('Notifications not supported');return;}
 Notification.requestPermission().then(p=>{
   if(p==='granted') new Notification('üìö Reminder',{body:'Check today‚Äôs homework! üîî'});
   else showToast('Allow notifications for reminders');
 });
}

/* ---------- OFFLINE ---------- */
window.addEventListener('online',()=>{document.getElementById('offlineBanner').classList.add('hidden');});
window.addEventListener('offline',()=>{document.getElementById('offlineBanner').classList.remove('hidden');});

/* ---------- PWA INSTALL ---------- */
let deferredPrompt=null;
window.addEventListener('beforeinstallprompt',e=>{deferredPrompt=e;});
function installPWA(){
 if(deferredPrompt){
   deferredPrompt.prompt();
   deferredPrompt.userChoice.then(()=>deferredPrompt=null);
 }else showToast('App already installed or not supported');
}

/* ---------- ADMIN HOOK ---------- */
function openAdmin(){
 const pwd=prompt('Enter Admin Password:');
 if(pwd==='Abutalha') location.href='admin.html';
 else showToast('‚ùå Wrong password');
}

/* ---------- PRINT ---------- */
function printHW(){window.print();}

/* ---------- CLEAR CACHE ---------- */
function clearCache(){
 localStorage.clear();
 caches.keys().then(names=>names.forEach(n=>caches.delete(n)));
 showToast('Cache cleared üßπ');
}

/* ---------- LOGOUT ---------- */
function logout(){
 localStorage.clear();
 location.href='index.html';
}

/* ---------- SCROLL TO TOP ---------- */
function scrollToTop(){window.scrollTo({top:0,behavior:'smooth'});}
</script>
</body>
</html>
