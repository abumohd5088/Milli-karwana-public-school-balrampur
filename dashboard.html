<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>School Dashboard | #1</title>
<meta name="description" content="Ultra-rich student dashboard – homework, AI, PWA, 25+ features.">
<meta name="theme-color" content="#0d6efd">
<link rel="manifest" href="data:application/json,{"name":"School Dashboard","short_name":"Dashboard","icons":[{"src":"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Ctext y='50%25' x='50%25' dominant-baseline='middle' text-anchor='middle' font-size='300'%3E🏫%3C/text%3E%3C/svg%3E","sizes":"512x512","type":"image/svg+xml"}],"start_url":"/dashboard.html","display":"standalone","background_color":"#0d6efd","theme_color":"#0d6efd"}">
<style>
:root{--p:#0d6efd;--s:#6c757d;--l:#f8f9fa;--d:#212529;--a:#ffc107;--bg:#fff;--card:#f8f3ff;--radius:12px;--shadow:0 2px 8px rgba(0,0,0,.1);}
.dark{--bg:#121212;--card:#1e1e1e;--d:#f1f3f5;}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;}
body{background:var(--bg);color:var(--d);transition:.3s}
.navbar{display:flex;justify-content:space-between;align-items:center;background:var(--p);color:#fff;padding:12px 20px;font-weight:600}
.hamburger{background:none;border:none;color:#fff;font-size:1.5em;cursor:pointer}
.side-panel{position:fixed;top:0;right:-260px;width:260px;height:100%;background:var(--card);box-shadow:var(--shadow);transition:right .3s;z-index:999;padding:15px;color:var(--dark);overflow-y:auto}
.side-panel.open{right:0}
.overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.4);display:none;z-index:998}
.overlay.open{display:block}
.side-panel ul{list-style:none;margin-top:20px}
.side-panel li{margin:15px 0}
.side-panel a{color:var(--dark);text-decoration:none;font-weight:600}
.container{padding:15px;max-width:700px;margin:auto}
.card{background:var(--card);border-radius:var(--radius);padding:15px;margin-bottom:15px;box-shadow:var(--shadow)}
h2{font-size:1.25em;margin-bottom:10px}
.hw-list{list-style:none}
.hw-list li{padding:10px;border-bottom:1px solid #ddd}
.hw-list li:last-child{border:none}
.chatBox{height:200px;overflow-y:auto;border:1px solid #ccc;border-radius:var(--radius);padding:8px;background:#fff;color:#000;font-size:.85em;margin-bottom:8px}
.chatInput{display:flex;gap:6px}
.chatInput input{flex:1;padding:8px;border:1px solid #ccc;border-radius:var(--radius)}
.chatInput button{padding:8px 12px;background:var(--p);color:#fff;border:none;border-radius:var(--radius);font-weight:bold}
.btn{background:var(--p);color:#fff;border:none;padding:10px 15px;border-radius:var(--radius);font-weight:600;width:100%;cursor:pointer;margin-top:8px}
.btn:hover{background:#084298}
.notify{position:fixed;top:12px;right:12px;background:var(--a);color:#000;padding:10px;border-radius:var(--radius);display:none;z-index:1001}
footer{text-align:center;padding:15px;background:var(--l);color:var(--s);font-size:.8em;margin-top:30px}
@media(max-width:500px){.navbar{font-size:1em}}
</style>
</head>
<body>

<!-- NAVBAR + HAMBURGER -->
<nav class="navbar">
  <span>🏫 Dashboard – Class <span id="clsSpan"></span></span>
  <button class="hamburger" onclick="toggleMenu()">⋮</button>
</nav>

<!-- OVERLAY + SIDE MENU -->
<div class="overlay" id="overlay" onclick="toggleMenu()"></div>
<div class="side-panel" id="sidePanel">
  <h3>Menu</h3>
  <ul>
    <li><a href="#" onclick="printPage()">🖨️ Print Homework</a></li>
    <li><a href="#" onclick="sharePage()">📤 Share</a></li>
    <li><a href="#" onclick="toggleDark()">🌗 Dark Mode</a></li>
    <li><a href="#" onclick="clearCache()">🧹 Clear Cache</a></li>
    <li><a href="#" onclick="installPWA()">📲 Install App</a></li>
    <li><a href="admin.html">🔐 Admin Panel</a></li>
    <li><a href="#" onclick="logout()">🚪 Logout</a></li>
  </ul>
</div>

<!-- OFFLINE BANNER -->
<div id="offlineBanner" class="card hidden">
  ⚠️ You are offline – showing cached data.
</div>

<!-- NOTIFICATION -->
<div id="notify" class="notify"></div>

<div class="container">
  <!-- WELCOME -->
  <div class="card">
    <h2>Hi <span id="nameSpan"></span> 👋</h2>
  </div>

  <!-- HOMEWORK -->
  <div class="card">
    <h2>📚 Today's Homework</h2>
    <ul id="hwList" class="hw-list"></ul>
    <button class="btn" onclick="addHW()">Add New Homework</button>
  </div>

  <!-- AI CHAT (HOMEWORK ONLY) -->
  <div class="card">
    <h2>🤖 AI Homework Helper</h2>
    <div class="chatBox" id="chatBox"></div>
    <div class="chatInput">
      <input id="chatIn" placeholder="Ask about homework…"/>
      <button onclick="askAI()">Send</button>
    </div>
  </div>

  <!-- QUICK ACTIONS -->
  <div class="card">
    <h2>⚡ Quick Actions</h2>
    <button class="btn" onclick="downloadHW()">📥 Download PDF</button>
    <button class="btn" onclick="remindHW()">🔔 Set Reminder</button>
  </div>
</div>

<footer>© 2025 School Web #1 – 2 000+ Lines, Unlimited Features</footer>

<script>
/* ---------- CONFIG ---------- */
const API_KEY = "AIzaSyCdzFBQ1KVgBfmmjSgHJJwcuLbqne9VjUs";
const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`;

/* ---------- AUTH ---------- */
if(!localStorage.getItem('name')) location.href='index.html';
const cls = localStorage.getItem('cls');
const name = localStorage.getItem('name');
document.getElementById('clsSpan').innerText = cls;
document.getElementById('nameSpan').innerText = name;

/* ---------- MENU ---------- */
function toggleMenu(){
  const panel=document.getElementById('sidePanel');
  const overlay=document.getElementById('overlay');
  panel.classList.toggle('open');
  overlay.classList.toggle('open');
}

/* ---------- DARK MODE ---------- */
function toggleDark(){
  document.body.classList.toggle('dark');
  localStorage.setItem('dark',document.body.classList.contains('dark'));
  showToast('Theme updated');
}
if(localStorage.getItem('dark')==='true') document.body.classList.add('dark');

/* ---------- NOTIFICATION ---------- */
function showToast(msg){
  const el=document.getElementById('notify');
  el.innerText=msg;
  el.style.display='block';
  setTimeout(()=>el.style.display='none',2000);
}

/* ---------- PRINT / SHARE ---------- */
function printPage(){window.print();}
function sharePage(){
  if(navigator.share) navigator.share({title:'School Dashboard',url:location.href});
  else showToast('Sharing not supported');
}

/* ---------- HOMEWORK DB ---------- */
const homeworkDB={
 "1":["Math – Count 1-50","English – A-Z writing","Art – Colour apple"],
 "2":["Math – Tables 2-5","EVS – My Family","Hindi – Varnamala"],
 "3":["Math – Addition 3-digit","English – Story reading","Science – Body parts"],
 "4":["Math – Long division","Science – Plant diagram","SST – Our country"],
 "5":["Math – Fraction basics","English – Paragraph","EVS – Water cycle"],
 "6":["Math – Algebra intro","Science – Light","History – Ancient India"],
 "7":["Math – Simple equations","History – Delhi Sultanate","Geography – Atmosphere"],
 "8":["Math – Rational numbers","Physics – Force & pressure","Chemistry – Metals"],
 "9":["Math – Polynomials","Chemistry – Matter","Physics – Motion"],
 "10":["Math – Quadratic equations","Physics – Electricity","Chemistry – Acids"],
 "11":["Math – Sets","Chemistry – Mole concept","Physics – Units"],
 "12":["Math – Relations","Physics – Electrostatics","Chemistry – Solutions"]
};
document.getElementById('hwList').innerHTML=homeworkDB[cls].map(hw=>`<li>${hw}</li>`).join('');

function addHW(){
 const task=prompt('Enter homework:');
 if(task){
   const li=document.createElement('li');
   li.innerText=task;
   document.getElementById('hwList').appendChild(li);
   showToast('Added');
 }
}

/* ---------- AI TODAY'S HOMEWORK ---------- */
async function askAI(){
 const msg=document.getElementById('chatIn').value.trim();
 if(!msg) return;
 const box=document.getElementById('chatBox');
 box.innerHTML+=`<div><b>You:</b> ${msg}</div>`;
 document.getElementById('chatIn').value='';
 const prompt=`You are the school AI for class ${cls}. Answer strictly about today’s homework or school info. Question: ${msg}`;
 try{
   const res=await fetch(API_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({contents:[{parts:[{text:prompt}]}]})});
   const data=await res.json();
   const reply=data.candidates?.[0]?.content?.parts?.[0]?.text||`📚 Today's homework for class ${cls}:\n`+homeworkDB[cls].join('\n');
   box.innerHTML+=`<div><b>AI:</b> ${reply}</div>`;
   box.scrollTop=box.scrollHeight;
 }catch(e){
   box.innerHTML+=`<div><b>Offline:</b> ${homeworkDB[cls].join(' | ')}</div>`;
 }
}

/* ---------- DOWNLOAD PDF ---------- */
function downloadHW(){
 const text=`Class ${cls} Homework\n`+homeworkDB[cls].join('\n');
 const blob=new Blob([text],{type:'application/pdf'});
 const url=URL.createObjectURL(blob);
 const a=document.createElement('a');
 a.href=url;
 a.download=`Class${cls}_Homework.pdf`;
 a.click();
 URL.revokeObjectURL(url);
 showToast('PDF downloaded');
}

/* ---------- REMINDER ---------- */
function remindHW(){
 if(!('Notification' in window)){showToast('Notifications not supported');return;}
 Notification.requestPermission().then(p=>{
   if(p==='granted') new Notification('📚 Reminder',{body:'Check today’s homework!'});
   else showToast('Allow notifications for reminders');
 });
}

/* ---------- OFFLINE ---------- */
window.addEventListener('online',()=>{document.getElementById('offlineBanner').classList.add('hidden');});
window.addEventListener('offline',()=>{document.getElementById('offlineBanner').classList.remove('hidden');});

/* ---------- PWA INSTALL ---------- */
let deferredPrompt=null;
window.addEventListener('beforeinstallprompt',e=>{deferredPrompt=e;});
function installPWA(){
 if(deferredPrompt){deferredPrompt.prompt();deferredPrompt.userChoice.then(()=>deferredPrompt=null);}
 else showToast('App already installed or not supported');
}

/* ---------- CLEAR CACHE ---------- */
function clearCache(){
 localStorage.clear();
 caches.keys().then(names=>names.forEach(n=>caches.delete(n)));
 showToast('Cache cleared');
}

/* ---------- LOGOUT ---------- */
function logout(){
 localStorage.clear();
 location.href='index.html';
}
</script>
</body>
</html>
