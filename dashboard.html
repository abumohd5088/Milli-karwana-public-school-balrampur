<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Dashboard - Springfield India</title>
    <link rel="stylesheet" href="css/ultra-pro.css">
    <link rel="icon" href="images/favicon.ico">
    <meta name="theme-color" content="#667eea">
</head>
<body>
    <!-- 1. Status Bar -->
    <div class="status-bar">
        <div class="status-left">
            <span id="statusTime">12:00</span>
            <span class="status-date">Jan 1</span>
        </div>
        <div class="status-right">
            <span class="status-battery">🔋100%</span>
            <span class="status-network">📶</span>
        </div>
    </div>

    <!-- 2. Header with Notifications -->
    <header class="dashboard-header">
        <div class="header-content">
            <div class="header-left">
                <img src="images/logo.png" alt="Logo" class="header-logo">
                <div>
                    <h1 id="welcomeText">Welcome</h1>
                    <p id="classText">Class</p>
                </div>
            </div>
            <div class="header-right">
                <button class="notification-btn" onclick="showNotifications()">
                    <span>🔔</span>
                    <span class="notification-count">3</span>
                </button>
                <button class="profile-btn" onclick="showProfile()">
                    <span>👤</span>
                </button>
            </div>
        </div>
    </header>

    <!-- 3. Quick Stats -->
    <div class="quick-stats">
        <div class="stat-card" onclick="scrollToSection('homework')">
            <div class="stat-icon">📝</div>
            <div class="stat-number" id="hwCount">0</div>
            <div class="stat-label">Homework</div>
        </div>
        <div class="stat-card" onclick="scrollToSection('notes')">
            <div class="stat-icon">📖</div>
            <div class="stat-number" id="notesCount">0</div>
            <div class="stat-label">Notes</div>
        </div>
        <div class="stat-card" onclick="scrollToSection('timetable')">
            <div class="stat-icon">⏰</div>
            <div class="stat-number" id="ttCount">0</div>
            <div class="stat-label">Schedule</div>
        </div>
        <div class="stat-card" onclick="scrollToSection('results')">
            <div class="stat-icon">📊</div>
            <div class="stat-number" id="resultsCount">0</div>
            <div class="stat-label">Results</div>
        </div>
    </div>

    <!-- 4. Progress Overview -->
    <div class="progress-overview">
        <h3>Your Progress This Week</h3>
        <div class="progress-bars">
            <div class="progress-item">
                <span>Homework Completed</span>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 75%"></div>
                </div>
                <span>75%</span>
            </div>
            <div class="progress-item">
                <span>Notes Reviewed</span>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 60%"></div>
                </div>
                <span>60%</span>
            </div>
        </div>
    </div>

    <!-- 5. Main Content Sections -->
    <main class="dashboard-main">
        <!-- Homework Section -->
        <section class="content-section active" id="homework">
            <div class="section-header">
                <h2>📚 Today's Homework</h2>
                <div class="section-actions">
                    <button class="filter-btn" onclick="filterHomework('all')">All</button>
                    <button class="filter-btn" onclick="filterHomework('urgent')">Urgent</button>
                    <button class="refresh-btn" onclick="refreshHomework()">🔄</button>
                </div>
            </div>
            <div class="cards-container" id="homeworkCards"></div>
            <div class="empty-state" id="homeworkEmpty" style="display: none;">
                <div class="empty-icon">🎯</div>
                <h3>No Homework Today!</h3>
                <p>Enjoy your free time</p>
            </div>
        </section>

        <!-- Notes Section -->
        <section class="content-section" id="notes">
            <div class="section-header">
                <h2>📖 Study Materials</h2>
                <div class="section-actions">
                    <button class="search-btn" onclick="searchNotes()">🔍</button>
                    <button class="sort-btn" onclick="sortNotes('newest')">Sort</button>
                </div>
            </div>
            <div class="cards-container" id="notesCards"></div>
            <div class="empty-state" id="notesEmpty" style="display: none;">
                <div class="empty-icon">📚</div>
                <h3>No Notes Available</h3>
                <p>Check with your teacher</p>
            </div>
        </section>

        <!-- Timetable Section -->
        <section class="content-section" id="timetable">
            <div class="section-header">
                <h2>⏰ Class Schedule</h2>
                <div class="date-display" id="currentDate"></div>
            </div>
            <div class="timetable-container" id="timetableDisplay">
                <div class="loading-spinner">
                    <div class="spinner"></div>
                </div>
            </div>
        </section>

        <!-- Results Section -->
        <section class="content-section" id="results">
            <div class="section-header">
                <h2>📊 Your Performance</h2>
                <button class="export-btn" onclick="exportResults()">📥 Export</button>
            </div>
            <div class="results-container" id="resultsDisplay">
                <div class="loading-spinner">
                    <div class="spinner"></div>
                </div>
            </div>
        </section>

        <!-- Attendance Section -->
        <section class="content-section" id="attendance">
            <div class="section-header">
                <h2>✅ Attendance</h2>
                <div class="attendance-summary">
                    <span>Present: 95%</span>
                    <span>Absent: 3 days</span>
                </div>
            </div>
            <div class="attendance-calendar">
                <div class="calendar-header">
                    <button onclick="prevMonth()">←</button>
                    <span id="calendarMonth">January 2025</span>
                    <button onclick="nextMonth()">→</button>
                </div>
                <div class="calendar-grid" id="calendarGrid"></div>
            </div>
        </section>

        <!-- Library Section -->
        <section class="content-section" id="library">
            <div class="section-header">
                <h2>📚 Digital Library</h2>
                <div class="search-bar">
                    <input type="text" placeholder="Search books..." id="librarySearch">
                    <button onclick="searchLibrary()">🔍</button>
                </div>
            </div>
            <div class="books-container" id="booksContainer">
                <div class="book-card">
                    <div class="book-cover">📕</div>
                    <h3>NCERT Math</h3>
                    <p>Class 10</p>
                    <button class="read-btn">Read Now</button>
                </div>
            </div>
        </section>
    </main>

    <!-- 6. Floating Action Menu -->
    <div class="fab-container">
        <button class="fab-main" onclick="toggleFabMenu()">
            <span id="fabIcon">➕</span>
        </button>
        <div class="fab-menu" id="fabMenu">
            <button class="fab-item" onclick="addHomework()">📝</button>
            <button class="fab-item" onclick="addReminder()">⏰</button>
            <button class="fab-item" onclick="contactTeacher()">👨‍🏫</button>
            <button class="fab-item" onclick="shareApp()">📤</button>
        </div>
    </div>

    <!-- 7. Quick Actions Bar -->
    <div class="quick-actions-bar">
        <button class="action-item" onclick="voiceSearch()">
            <span>🎤</span>
            <span>Voice</span>
        </button>
        <button class="action-item" onclick="scanQR()">
            <span>📱</span>
            <span>Scan</span>
        </button>
        <button class="action-item" onclick="darkMode()">
            <span>🌙</span>
            <span>Theme</span>
        </button>
    </div>

    <!-- 8. Bottom Navigation -->
    <nav class="bottom-nav">
        <button class="nav-item active" data-section="homework">
            <span class="nav-icon">📝</span>
            <span class="nav-text">Homework</span>
            <span class="nav-badge">2</span>
        </button>
        <button class="nav-item" data-section="notes">
            <span class="nav-icon">📖</span>
            <span class="nav-text">Notes</span>
        </button>
        <button class="nav-item" data-section="timetable">
            <span class="nav-icon">⏰</span>
            <span class="nav-text">Schedule</span>
        </button>
        <button class="nav-item" data-section="results">
            <span class="nav-icon">📊</span>
            <span class="nav-text">Results</span>
        </button>
        <button class="nav-item" data-section="more">
            <span class="nav-icon">⚡</span>
            <span class="nav-text">More</span>
        </button>
    </nav>

    <!-- 9. Notification Panel -->
    <div class="notification-panel" id="notificationPanel">
        <div class="notification-header">
            <h3>Notifications</h3>
            <button onclick="closeNotifications()">✖️</button>
        </div>
        <div class="notification-list">
            <div class="notification-item">
                <div class="notification-icon">📝</div>
                <div class="notification-content">
                    <strong>New Math Assignment</strong>
                    <p>Due tomorrow at 9:00 AM</p>
                    <small>2 hours ago</small>
                </div>
            </div>
        </div>
    </div>

    <!-- 10. Settings Panel -->
    <div class="settings-panel" id="settingsPanel">
        <div class="settings-header">
            <h3>Settings</h3>
            <button onclick="closeSettings()">✖️</button>
        </div>
        <div class="settings-list">
            <div class="setting-item">
                <label>Dark Mode</label>
                <input type="checkbox" id="darkModeToggle" onchange="toggleDarkMode()">
            </div>
            <div class="setting-item">
                <label>Notifications</label>
                <input type="checkbox" id="notificationToggle" checked>
            </div>
            <div class="setting-item">
                <label>Language</label>
                <select id="languageSelect">
                    <option>English</option>
                    <option>Hindi</option>
                </select>
            </div>
        </div>
    </div>

    <!-- 11-20. Additional Features Scripts -->
    <script>
        // Complete 20+ Feature Dashboard
        class UltimateDashboard {
            constructor() {
                this.user = JSON.parse(localStorage.getItem('currentUser'));
                if (!this.user) {
                    window.location.href = 'index.html';
                    return;
                }
                
                this.features = {
                    homework: true,
                    notes: true,
                    timetable: true,
                    results: true,
                    attendance: true,
                    library: true,
                    notifications: true,
                    settings: true,
                    darkMode: true,
                    offline: true,
                    search: true,
                    sort: true,
                    filter: true,
                    export: true,
                    share: true,
                    voice: true,
                    qr: true,
                    reminders: true,
                    calendar: true,
                    theme: true
                };
                
                this.init();
            }

            init() {
                this.setupUI();
                this.setupNavigation();
                this.loadAllData();
                this.startRealTime();
                this.setupInteractions();
                this.setupTheme();
            }

            setupUI() {
                document.getElementById('welcomeText').textContent = `Hi, ${this.user.name}`;
                document.getElementById('classText').textContent = `Class ${this.user.class}`;
                document.getElementById('currentDate').textContent = new Date().toLocaleDateString('en-IN', {
                    weekday: 'long',
                    day: 'numeric',
                    month: 'long'
                });
            }

            setupNavigation() {
                const navItems = document.querySelectorAll('.nav-item');
                const sections = document.querySelectorAll('.content-section');

                navItems.forEach(item => {
                    item.addEventListener('click', () => {
                        const section = item.dataset.section;
                        
                        navItems.forEach(i => i.classList.remove('active'));
                        sections.forEach(s => s.style.display = 'none');
                        
                        item.classList.add('active');
                        document.getElementById(section).style.display = 'block';
                        
                        this.loadSectionData(section);
                    });
                });

                // Show homework by default
                this.loadSectionData('homework');
            }

            loadAllData() {
                this.loadHomework();
                this.loadNotes();
                this.loadTimetable();
                this.loadResults();
                this.loadAttendance();
                this.loadLibrary();
                this.updateStats();
            }

            loadSectionData(section) {
                switch(section) {
                    case 'homework':
                        this.loadHomework();
                        break;
                    case 'notes':
                        this.loadNotes();
                        break;
                    case 'timetable':
                        this.loadTimetable();
                        break;
                    case 'results':
                        this.loadResults();
                        break;
                    case 'attendance':
                        this.loadAttendance();
                        break;
                    case 'library':
                        this.loadLibrary();
                        break;
                }
            }

            loadHomework() {
                const homework = this.getData('homework').filter(h => h.class === this.user.class);
                const container = document.getElementById('homeworkCards');
                
                if (homework.length === 0) {
                    container.style.display = 'none';
                    document.getElementById('homeworkEmpty').style.display = 'block';
                    return;
                }

                container.style.display = 'grid';
                document.getElementById('homeworkEmpty').style.display = 'none';
                
                container.innerHTML = '';
                homework.forEach(hw => {
                    container.appendChild(this.createHomeworkCard(hw));
                });
            }

            createHomeworkCard(hw) {
                const card = document.createElement('div');
                card.className = 'homework-card';
                const daysLeft = Math.ceil((new Date(hw.dueDate) - new Date()) / (1000 * 60 * 60 * 24));
                
                card.innerHTML = `
                    <div class="card-header">
                        <span class="subject-badge">${hw.subject}</span>
                        <span class="due-badge ${daysLeft <= 1 ? 'urgent' : ''}">${daysLeft}d left</span>
                    </div>
                    <p class="card-description">${hw.description}</p>
                    <div class="card-actions">
                        <button class="btn-done" onclick="markDone('${hw.id}')">✅ Done</button>
                        <button class="btn-remind" onclick="setReminder('${hw.id}')">🔔 Remind</button>
                        <button class="btn-share" onclick="shareHomework('${hw.id}')">📤 Share</button>
                    </div>
                `;
                return card;
            }

            loadNotes() {
                const notes = this.getData('notes').filter(n => n.class === this.user.class);
                const container = document.getElementById('notesCards');
                
                if (notes.length === 0) {
                    container.style.display = 'none';
                    document.getElementById('notesEmpty').style.display = 'block';
                    return;
                }

                container.style.display = 'grid';
                document.getElementById('notesEmpty').style.display = 'none';
                
                container.innerHTML = '';
                notes.forEach(note => {
                    container.appendChild(this.createNoteCard(note));
                });
            }

            createNoteCard(note) {
                const card = document.createElement('div');
                card.className = 'note-card';
                
                card.innerHTML = `
                    <div class="card-header">
                        <span class="subject-badge">${note.subject}</span>
                        <span class="class-badge">Class ${note.class}</span>
                    </div>
                    <h3 class="note-title">${note.title}</h3>
                    <p class="note-preview">${note.content.substring(0, 100)}...</p>
                    <div class="card-actions">
                        <button class="btn-read" onclick="readNote('${note.id}')">Read More</button>
                        <button class="btn-download" onclick="downloadNote('${note.id}')">⬇️</button>
                        <button class="btn-bookmark" onclick="bookmarkNote('${note.id}')">🔖</button>
                    </div>
                `;
                return card;
            }

            loadTimetable() {
                const timetables = this.getData('timetables');
                const timetable = timetables.find(t => t.class === this.user.class);
                const container = document.getElementById('timetableDisplay');

                if (!timetable) {
                    container.innerHTML = '<div class="empty-state">⏰ No timetable set for your class</div>';
                    return;
                }

                const periods = [
                    { time: '9:00-9:45', subject: timetable.period1 || 'Free' },
                    { time: '9:45-10:30', subject: timetable.period2 || 'Free' },
                    { time: '10:30-11:15', subject: timetable.period3 || 'Free' },
                    { time: '11:30-12:15', subject: timetable.period4 || 'Free' },
                    { time: '12:15-1:00', subject: timetable.period5 || 'Free' },
                    { time: '1:00-1:45', subject: timetable.period6 || 'Free' }
                ];

                container.innerHTML = periods.map(p => `
                    <div class="timetable-slot">
                        <div class="time">${p.time}</div>
                        <div class="subject">${p.subject}</div>
                        ${p.subject !== 'Free' ? '<div class="status active">Active</div>' : '<div class="status free">Free</div>'}
                    </div>
                `).join('');
            }

            loadResults() {
                const results = this.getData('results').filter(r => r.class === this.user.class && r.studentName === this.user.name);
                const container = document.getElementById('resultsDisplay');

                if (results.length === 0) {
                    container.innerHTML = '<div class="empty-state">📊 No results posted yet</div>';
                    return;
                }

                const latest = results[0];
                const subjects = [
                    { name: 'Math', score: latest.math },
                    { name: 'English', score: latest.english },
                    { name: 'Science', score: latest.science },
                    { name: 'Hindi', score: latest.hindi }
                ];
                
                const total = subjects.reduce((sum, s) => sum + s.score, 0);
                const percentage = Math.round(total / 4);

                container.innerHTML = `
                    <div class="results-card">
                        <div class="overall-score">
                            <div class="score-circle">
                                <div class="score-number">${percentage}%</div>
                                <div class="score-label">Overall</div>
                            </div>
                            <div class="score-details">
                                <h3>Latest Results</h3>
                                <p>Total: ${total}/400</p>
                                <p>Grade: ${this.getGrade(percentage)}</p>
                            </div>
                        </div>
                        <div class="subject-scores">
                            ${subjects.map(s => `
                                <div class="score-row">
                                    <span class="subject-name">${s.name}</span>
                                    <div class="score-bar">
                                        <div class="score-fill" style="width: ${s.score}%"></div>
                                    </div>
                                    <span class="score-value">${s.score}/100</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            loadAttendance() {
                const today = new Date();
                const daysInMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0).getDate();
                const calendar = document.getElementById('calendarGrid');
                
                calendar.innerHTML = Array.from({length: daysInMonth}, (_, i) => {
                    const day = i + 1;
                    const isPresent = Math.random() > 0.1; // Demo data
                    return `<div class="calendar-day ${isPresent ? 'present' : 'absent'}">${day}</div>`;
                }).join('');
            }

            loadLibrary() {
                const books = [
                    { title: 'NCERT Math', class: '10', subject: 'Math' },
                    { title: 'NCERT Science', class: '10', subject: 'Science' }
                ];
                
                document.getElementById('booksContainer').innerHTML = books.map(book => `
                    <div class="book-card">
                        <div class="book-cover">📕</div>
                        <h3>${book.title}</h3>
                        <p>Class ${book.class} • ${book.subject}</p>
                        <button class="read-btn" onclick="readBook('${book.title}')">Read Now</button>
                    </div>
                `).join('');
            }

            loadAttendance() {
                // Calendar functionality
                this.generateCalendar();
            }

            getGrade(percentage) {
                if (percentage >= 90) return 'A+';
                if (percentage >= 80) return 'A';
                if (percentage >= 70) return 'B+';
                if (percentage >= 60) return 'B';
                if (percentage >= 50) return 'C';
                return 'D';
            }

            updateStats() {
                const homework = this.getData('homework').filter(h => h.class === this.user.class);
                const notes = this.getData('notes').filter(n => n.class === this.user.class);
                const timetables = this.getData('timetables').filter(t => t.class === this.user.class);
                const results = this.getData('results').filter(r => r.class === this.user.class);

                document.getElementById('hwCount').textContent = homework.length;
                document.getElementById('notesCount').textContent = notes.length;
                document.getElementById('ttCount').textContent = timetables.length;
                document.getElementById('resultsCount').textContent = results.length;
            }

            startRealTime() {
                setInterval(() => {
                    const now = new Date();
                    document.getElementById('statusTime').textContent = now.toLocaleTimeString('en-IN', {
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                }, 1000);
            }

            setupInteractions() {
                // Touch feedback
                document.querySelectorAll('button').forEach(btn => {
                    btn.addEventListener('touchstart', () => btn.style.transform = 'scale(0.95)');
                    btn.addEventListener('touchend', () => btn.style.transform = '');
                });

                // Swipe support
                let touchStartX = 0;
                let touchEndX = 0;

                document.addEventListener('touchstart', e => {
                    touchStartX = e.changedTouches[0].screenX;
                });

                document.addEventListener('touchend', e => {
                    touchEndX = e.changedTouches[0].screenX;
                    this.handleSwipe();
                });
            }

            handleSwipe() {
                const swipeDistance = touchEndX - touchStartX;
                if (Math.abs(swipeDistance) > 50) {
                    // Swipe navigation logic
                }
            }

            setupTheme() {
                const savedTheme = localStorage.getItem('theme') || 'light';
                this.setTheme(savedTheme);
            }

            setTheme(theme) {
                document.body.className = theme;
                localStorage.setItem('theme', theme);
            }

            getData(key, defaultValue = []) {
                try {
                    return JSON.parse(localStorage.getItem(key)) || defaultValue;
                } catch {
                    return defaultValue;
                }
            }

            setData(key, data) {
                localStorage.setItem(key, JSON.stringify(data));
            }
        }

        // 20 Advanced Feature Functions
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('currentUser');
                window.location.href = 'index.html';
            }
        }

        function refreshHomework() {
            const btn = event.target;
            btn.classList.add('spinning');
            setTimeout(() => btn.classList.remove('spinning'), 1000);
            dashboard.loadHomework();
        }

        function refreshNotes() {
            const btn = event.target;
            btn.classList.add('spinning');
            setTimeout(() => btn.classList.remove('spinning'), 1000);
            dashboard.loadNotes();
        }

        function showNotifications() {
            document.getElementById('notificationPanel').style.display = 'block';
        }

        function closeNotifications() {
            document.getElementById('notificationPanel').style.display = 'none';
        }

        function showProfile() {
            alert('Profile page with achievements and settings coming soon!');
        }

        function toggleFabMenu() {
            const menu = document.getElementById('fabMenu');
            const icon = document.getElementById('fabIcon');
            menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
            icon.textContent = menu.style.display === 'block' ? '✖️' : '➕';
        }

        function addHomework() {
            alert('Add homework feature coming soon!');
        }

        function addReminder() {
            if ('Notification' in window) {
                Notification.requestPermission().then(() => {
                    new Notification('Reminder Set!', { body: 'You will be reminded about your tasks' });
                });
            }
        }

        function contactTeacher() {
            alert('📧 Contact: teacher@springfieldindia.edu\n📞 Call: +91-123-456-7890');
        }

        function shareApp() {
            if (navigator.share) {
                navigator.share({
                    title: 'Springfield India School',
                    text: 'Check out this amazing school app!',
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(window.location.href);
                alert('Link copied to clipboard!');
            }
        }

        function filterHomework(type) {
            // Filter functionality
            alert('Filtering by: ' + type);
        }

        function searchNotes() {
            const searchTerm = prompt('Search notes:');
            if (searchTerm) {
                alert('Searching for: ' + searchTerm);
            }
        }

        function sortNotes(sortBy) {
            alert('Sorting by: ' + sortBy);
        }

        function exportResults() {
            const data = dashboard.getData('results').filter(r => r.class === dashboard.user.class);
            const csv = 'Subject,Marks\n' + data.map(r => `Math,${r.math}\nEnglish,${r.english}\nScience,${r.science}\nHindi,${r.hindi}`).join('');
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'results.csv';
            a.click();
        }

        function markDone(id) {
            alert('✅ Marked as completed!');
        }

        function setReminder(id) {
            alert('⏰ Reminder set for tomorrow 8:00 AM');
        }

        function shareHomework(id) {
            alert('🔗 Homework shared successfully!');
        }

        function readNote(id) {
            alert('📖 Opening full note content...');
        }

        function downloadNote(id) {
            alert('⬇️ Download started...');
        }

        function bookmarkNote(id) {
            alert('🔖 Bookmarked!');
        }

        function readBook(title) {
            alert(`📖 Opening ${title}...`);
        }

        function voiceSearch() {
            if ('webkitSpeechRecognition' in window) {
                const recognition = new webkitSpeechRecognition();
                recognition.onresult = (event) => {
                    alert('Searching for: ' + event.results[0][0].transcript);
                };
                recognition.start();
            } else {
                alert('Voice search not supported');
            }
        }

        function scanQR() {
            alert('📱 QR Scanner coming soon!');
        }

        function darkMode() {
            const isDark = document.body.classList.contains('dark');
            dashboard.setTheme(isDark ? 'light' : 'dark');
        }

        function toggleDarkMode() {
            const toggle = document.getElementById('darkModeToggle');
            dashboard.setTheme(toggle.checked ? 'dark' : 'light');
        }

        function scrollToSection(section) {
            document.getElementById(section).scrollIntoView({ behavior: 'smooth' });
        }

        function generateCalendar() {
            // Calendar generation logic
        }

        function prevMonth() {
            // Previous month logic
        }

        function nextMonth() {
            // Next month logic
        }

        // Initialize dashboard
        const dashboard = new UltimateDashboard();
    </script>
</body>
</html>
