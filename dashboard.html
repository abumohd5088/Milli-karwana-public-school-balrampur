<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Student Dashboard | Milli Karwaan Public School</title>
  <link rel="icon" type="image/png" href="https://i.postimg.cc/ryGx49TB/erasebg-transformed.png">
  <style>
    /* Reset & Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    :root {
      --bg-primary: #f8fafc;
      --bg-secondary: #ffffff;
      --bg-tertiary: #f1f5f9;
      --text-primary: #0f172a;
      --text-secondary: #475569;
      --text-tertiary: #64748b;
      --accent: #0d6efd;
      --accent-light: #e3f2fd;
      --accent-dark: #0b5ed7;
      --success: #198754;
      --success-light: #d1e7dd;
      --warning: #ffc107;
      --warning-light: #fff3cd;
      --danger: #dc3545;
      --danger-light: #f8d7da;
      --border: #e2e8f0;
      --border-light: #f1f5f9;
      --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
      --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      --shadow-xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      --radius: 20px;
      --radius-md: 12px;
      --radius-sm: 8px;
      --transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
      --glow: 0 0 30px rgba(13, 110, 253, 0.25);
      --animation-slow: cubic-bezier(0.25, 0.46, 0.45, 0.94);
      --animation-fast: cubic-bezier(0.68, -0.55, 0.265, 1.55);
      --header-height: 64px;
      --bottom-nav-height: 60px;
      --sidebar-width: 280px;
    }

    [data-theme="dark"] {
      --bg-primary: #0f172a;
      --bg-secondary: #1e293b;
      --bg-tertiary: #334155;
      --text-primary: #e2e8f0;
      --text-secondary: #94a3b8;
      --text-tertiary: #cbd5e1;
      --accent: #3b82f6;
      --accent-light: #1e3a8a;
      --accent-dark: #2563eb;
      --success: #15803d;
      --success-light: #064e3b;
      --warning: #d97706;
      --warning-light: #7c2d12;
      --danger: #b91c1c;
      --danger-light: #7f1d1d;
      --border: #334155;
      --border-light: #1e293b;
      --glow: 0 0 35px rgba(59, 130, 246, 0.3);
    }

    body {
      font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Helvetica Neue', sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.7;
      transition: var(--transition);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
    }

    /* Layout */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
      flex: 1;
    }

    /* Sidebar */
    .sidebar {
      width: var(--sidebar-width);
      background: var(--bg-secondary);
      border-right: 1px solid var(--border);
      position: fixed;
      left: -100%;
      top: 0;
      height: 100vh;
      z-index: 60;
      transition: var(--transition);
      box-shadow: var(--shadow-md);
      overflow-y: auto;
    }

    .sidebar.open {
      left: 0;
    }

    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .sidebar-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--text-tertiary);
    }

    .sidebar-menu {
      padding: 1rem 0;
    }

    .sidebar-item {
      padding: 0.8rem 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.8rem;
      cursor: pointer;
      transition: var(--transition);
      color: var(--text-secondary);
    }

    .sidebar-item:hover {
      background: var(--bg-tertiary);
      color: var(--text-primary);
    }

    .sidebar-item.active {
      background: var(--accent-light);
      color: var(--accent-dark);
      font-weight: 500;
    }

    .sidebar-item i {
      font-size: 1.2rem;
    }

    /* Header */
    header {
      height: var(--header-height);
      background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%);
      color: white;
      position: sticky;
      top: 0;
      z-index: 50;
      box-shadow: var(--shadow-md);
      display: flex;
      align-items: center;
      padding: 0 1rem;
      justify-content: space-between;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .menu-toggle {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
      display: none;
    }

    .menu-toggle:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-2px);
    }

    .logo-section {
      display: flex;
      align-items: center;
      gap: 0.8rem;
    }

    .logo {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 2px solid rgba(255, 255, 255, 0.3);
    }

    .school-title {
      font-size: 1.1rem;
      font-weight: 600;
      white-space: nowrap;
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .notification-btn, .profile-btn, .theme-toggle {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
    }

    .notification-btn:hover, .profile-btn:hover, .theme-toggle:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-2px);
    }

    .notification-badge {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 18px;
      height: 18px;
      background: var(--danger);
      color: white;
      font-size: 0.7rem;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
    }

    /* Main Content */
    main {
      padding: 1.5rem 0;
      flex: 1;
      margin-left: 0;
      transition: margin-left 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    }

    main.sidebar-open {
      margin-left: var(--sidebar-width);
    }

    .welcome-section {
      text-align: center;
      margin-bottom: 2rem;
      padding: 1.5rem;
      background: linear-gradient(135deg, var(--accent-light) 0%, var(--bg-tertiary) 100%);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }

    .welcome-title {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--accent-dark);
    }

    [data-theme="dark"] .welcome-title {
      color: var(--accent);
    }

    .welcome-subtitle {
      color: var(--text-secondary);
      font-size: 1rem;
    }

    .quick-stats {
      display: flex;
      gap: 1rem;
      margin-bottom: 2rem;
      overflow-x: auto;
      padding-bottom: 0.5rem;
      scrollbar-width: thin;
    }

    .stat-card {
      min-width: 180px;
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-sm);
      padding: 1rem;
      border: 1px solid var(--border);
    }

    .stat-value {
      font-size: 1.8rem;
      font-weight: 600;
      color: var(--accent);
    }

    .stat-label {
      color: var(--text-tertiary);
      font-size: 0.9rem;
    }

    /* Grid Layout */
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    /* Cards */
    .card {
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow);
      overflow: hidden;
      transition: var(--transition);
      border: 1px solid var(--border);
      position: relative;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
    }

    .card-header {
      padding: 1.2rem 1.5rem;
      background: var(--bg-tertiary);
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 0.8rem;
      justify-content: space-between;
    }

    .card-header-actions {
      display: flex;
      gap: 0.5rem;
    }

    .card-action-btn {
      background: none;
      border: none;
      color: var(--text-tertiary);
      cursor: pointer;
      font-size: 1rem;
      padding: 0.2rem;
      transition: var(--transition);
    }

    .card-action-btn:hover {
      color: var(--text-primary);
    }

    .card-icon {
      width: 36px;
      height: 36px;
      background: var(--accent-light);
      color: var(--accent);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
    }

    [data-theme="dark"] .card-icon {
      background: rgba(59, 130, 246, 0.2);
      color: var(--accent);
    }

    .card-title {
      font-size: 1.1rem;
      font-weight: 600;
    }

    .card-body {
      padding: 1.5rem;
    }

    /* Timetable */
    .timetable {
      width: 100%;
      border-collapse: collapse;
    }

    .timetable th {
      text-align: left;
      padding: 0.8rem 0.5rem;
      font-weight: 600;
      color: var(--text-secondary);
      font-size: 0.9rem;
      border-bottom: 2px solid var(--border);
    }

    .timetable td {
      padding: 0.7rem 0.5rem;
      border-bottom: 1px solid var(--border-light);
      font-size: 0.95rem;
    }

    .subject {
      font-weight: 500;
      color: var(--text-primary);
    }

    .time {
      color: var(--text-tertiary);
      font-size: 0.85rem;
    }

    .class-status {
      display: inline-block;
      padding: 0.2rem 0.5rem;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 500;
      margin-left: 0.5rem;
    }

    .status-current {
      background: rgba(25, 135, 84, 0.1);
      color: var(--success);
    }

    .status-upcoming {
      background: rgba(255, 193, 7, 0.1);
      color: var(--warning);
    }

    /* Homework List */
    .homework-list {
      list-style: none;
    }

    .homework-item {
      padding: 0.8rem 0;
      border-bottom: 1px solid var(--border-light);
      display: flex;
      align-items: flex-start;
      gap: 0.8rem;
      cursor: pointer;
      transition: var(--transition);
    }

    .homework-item:hover {
      background: var(--bg-tertiary);
      border-radius: var(--radius-sm);
      padding: 0.8rem;
    }

    .homework-item:last-child {
      border-bottom: none;
    }

    .hw-icon {
      color: var(--accent);
      font-size: 1.1rem;
      margin-top: 0.2rem;
    }

    .hw-content {
      flex: 1;
    }

    .hw-title {
      font-weight: 500;
      margin-bottom: 0.2rem;
    }

    .hw-subject {
      font-size: 0.85rem;
      color: var(--text-tertiary);
      margin-bottom: 0.3rem;
    }

    .hw-date {
      font-size: 0.8rem;
      color: var(--text-tertiary);
    }

    .hw-priority {
      display: inline-block;
      padding: 0.1rem 0.4rem;
      border-radius: 12px;
      font-size: 0.7rem;
      font-weight: 500;
      margin-left: 0.5rem;
    }

    .priority-high {
      background: rgba(220, 53, 69, 0.1);
      color: var(--danger);
    }

    .priority-medium {
      background: rgba(255, 193, 7, 0.1);
      color: var(--warning);
    }

    .priority-low {
      background: rgba(25, 135, 84, 0.1);
      color: var(--success);
    }

    /* Upload Area */
    .upload-area {
      border: 2px dashed var(--border);
      border-radius: var(--radius-md);
      padding: 1.5rem;
      text-align: center;
      cursor: pointer;
      transition: var(--transition);
      position: relative;
    }

    .upload-area:hover {
      border-color: var(--accent);
      background: rgba(13, 110, 253, 0.03);
    }

    .upload-icon {
      font-size: 2.5rem;
      color: var(--accent);
      margin-bottom: 0.8rem;
    }

    .upload-text {
      color: var(--text-secondary);
      margin-bottom: 0.5rem;
    }

    .upload-btn {
      background: var(--accent);
      color: white;
      border: none;
      padding: 0.6rem 1.2rem;
      border-radius: var(--radius-sm);
      font-size: 0.95rem;
      cursor: pointer;
      transition: var(--transition);
    }

    .upload-btn:hover {
      background: var(--accent-dark);
    }

    .file-input {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      opacity: 0;
      cursor: pointer;
    }

    .upload-preview {
      margin-top: 1rem;
      display: none;
    }

    .upload-preview.active {
      display: block;
    }

    .preview-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem;
      background: var(--bg-tertiary);
      border-radius: var(--radius-sm);
      margin-bottom: 0.5rem;
    }

    .preview-name {
      flex: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .preview-remove {
      color: var(--danger);
      cursor: pointer;
    }

    /* Messages */
    .messages {
      display: flex;
      flex-direction: column;
      gap: 0.8rem;
    }

    .message {
      display: flex;
      align-items: flex-start;
      gap: 0.8rem;
      padding: 0.8rem;
      background: var(--bg-tertiary);
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: var(--transition);
    }

    .message:hover {
      background: var(--accent-light);
    }

    .message-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--accent-light);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--accent);
      font-weight: 600;
      font-size: 0.9rem;
    }

    .message-content {
      flex: 1;
    }

    .message-sender {
      font-weight: 500;
      font-size: 0.95rem;
      margin-bottom: 0.2rem;
    }

    .message-text {
      font-size: 0.9rem;
      color: var(--text-secondary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 200px;
    }

    .message-time {
      font-size: 0.8rem;
      color: var(--text-tertiary);
    }

    .message-unread {
      background: var(--accent-light);
    }

    /* AI Assistant */
    .ai-container {
      position: relative;
    }

    .ai-avatar {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      font-size: 1.2rem;
      margin: 0 auto 1rem;
      box-shadow: var(--shadow);
    }

    .ai-message {
      background: var(--accent-light);
      color: var(--accent-dark);
      padding: 1rem;
      border-radius: var(--radius-sm);
      font-size: 0.95rem;
      margin-bottom: 1rem;
      text-align: center;
    }

    [data-theme="dark"] .ai-message {
      background: rgba(59, 130, 246, 0.2);
      color: var(--accent);
    }

    .ai-input {
      display: flex;
      gap: 0.5rem;
    }

    .ai-input input {
      flex: 1;
      padding: 0.8rem 1rem;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      background: var(--bg-primary);
      color: var(--text-primary);
    }

    .ai-input input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.2);
    }

    .ai-input button {
      background: var(--accent);
      color: white;
      border: none;
      width: 48px;
      height: 48px;
      border-radius: var(--radius-sm);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .ai-input button:hover {
      background: var(--accent-dark);
    }

    /* Calendar */
    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 0.5rem;
    }

    .calendar-header {
      grid-column: span 7;
      text-align: center;
      font-weight: 600;
      margin-bottom: 1rem;
      font-size: 1.1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .calendar-nav {
      display: flex;
      gap: 0.5rem;
    }

    .calendar-nav-btn {
      background: none;
      border: none;
      cursor: pointer;
      color: var(--text-tertiary);
      font-size: 1.2rem;
      padding: 0.2rem;
      transition: var(--transition);
    }

    .calendar-nav-btn:hover {
      color: var(--text-primary);
    }

    .calendar-day {
      text-align: center;
      font-size: 0.85rem;
      color: var(--text-tertiary);
      font-weight: 500;
    }

    .calendar-date {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0.2rem auto;
      cursor: pointer;
      transition: var(--transition);
      font-size: 0.95rem;
    }

    .calendar-date:hover {
      background: var(--accent-light);
      color: var(--accent);
    }

    .calendar-date.today {
      background: var(--accent);
      color: white;
      font-weight: 600;
    }

    .calendar-date.event {
      position: relative;
    }

    .calendar-date.event::after {
      content: '';
      position: absolute;
      bottom: 2px;
      left: 50%;
      transform: translateX(-50%);
      width: 6px;
      height: 6px;
      background: var(--accent);
      border-radius: 50%;
    }

    .calendar-date.past {
      color: var(--text-tertiary);
      opacity: 0.6;
    }

    /* Progress Chart */
    .progress-container {
      height: 200px;
      position: relative;
    }

    .progress-chart {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: flex-end;
      gap: 1rem;
      padding: 1rem 0;
    }

    .progress-bar {
      flex: 1;
      background: var(--accent-light);
      border-radius: 8px 8px 0 0;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .bar-fill {
      width: 100%;
      background: var(--accent);
      border-radius: 8px 8px 0 0;
      transition: height 0.6s ease;
    }

    .bar-label {
      margin-top: 0.5rem;
      font-size: 0.8rem;
      color: var(--text-tertiary);
    }

    .bar-value {
      position: absolute;
      top: -1.5rem;
      font-size: 0.9rem;
      font-weight: 500;
    }

    /* Attendance */
    .attendance-summary {
      display: flex;
      justify-content: space-between;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid var(--border);
    }

    .attendance-stat {
      text-align: center;
    }

    .attendance-value {
      font-size: 1.5rem;
      font-weight: 600;
    }

    .attendance-label {
      font-size: 0.8rem;
      color: var(--text-tertiary);
    }

    .attendance-days {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 0.5rem;
    }

    .attendance-day {
      aspect-ratio: 1;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      cursor: pointer;
      transition: var(--transition);
    }

    .attendance-day.present {
      background: var(--success);
      color: white;
    }

    .attendance-day.absent {
      background: var(--danger);
      color: white;
    }

    .attendance-day.leave {
      background: var(--warning);
      color: var(--text-primary);
    }

    .attendance-day.weekend {
      background: var(--border-light);
      color: var(--text-tertiary);
    }

    /* Export Data */
    .export-options {
      display: flex;
      flex-direction: column;
      gap: 0.8rem;
    }

    .export-btn {
      display: flex;
      align-items: center;
      gap: 0.8rem;
      padding: 0.8rem 1rem;
      background: var(--bg-tertiary);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: var(--transition);
    }

    .export-btn:hover {
      background: var(--accent-light);
      border-color: var(--accent);
    }

    .export-icon {
      color: var(--accent);
      font-size: 1.2rem;
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 2rem 1rem;
      color: var(--text-tertiary);
    }

    .empty-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
      opacity: 0.3;
    }

    /* Modal */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
      opacity: 0;
      visibility: hidden;
      transition: var(--transition);
    }

    .modal.open {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
      width: 90%;
      max-width: 500px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: var(--shadow-xl);
      border: 1px solid var(--border);
    }

    .modal-header {
      padding: 1.5rem;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .modal-title {
      font-size: 1.2rem;
      font-weight: 600;
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--text-tertiary);
    }

    .modal-body {
      padding: 1.5rem;
    }

    .modal-footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: flex-end;
      gap: 0.8rem;
    }

    .btn {
      padding: 0.6rem 1.2rem;
      border-radius: var(--radius-sm);
      font-size: 0.95rem;
      cursor: pointer;
      transition: var(--transition);
      border: none;
    }

    .btn-primary {
      background: var(--accent);
      color: white;
    }

    .btn-primary:hover {
      background: var(--accent-dark);
    }

    .btn-secondary {
      background: var(--bg-tertiary);
      color: var(--text-primary);
    }

    .btn-secondary:hover {
      background: var(--border-light);
    }

    .form-group {
      margin-bottom: 1rem;
    }

    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
      color: var(--text-secondary);
    }

    .form-control {
      width: 100%;
      padding: 0.8rem;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      background: var(--bg-primary);
      color: var(--text-primary);
    }

    .form-control:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.2);
    }

    /* Toast Notification */
    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--bg-secondary);
      color: var(--text-primary);
      padding: 1rem 1.5rem;
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-lg);
      z-index: 1000;
      transform: translateX(120%);
      transition: transform 0.4s ease;
      border-left: 4px solid var(--accent);
    }

    .toast.show {
      transform: translateX(0);
    }

    .toast.success {
      border-left-color: var(--success);
    }

    .toast.warning {
      border-left-color: var(--warning);
    }

    .toast.danger {
      border-left-color: var(--danger);
    }

    /* Filters */
    .filters {
      display: flex;
      gap: 0.8rem;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }

    .filter-btn {
      padding: 0.5rem 1rem;
      background: var(--bg-tertiary);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      font-size: 0.9rem;
      cursor: pointer;
      transition: var(--transition);
    }

    .filter-btn.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    .filter-btn:hover {
      background: var(--accent-light);
      border-color: var(--accent);
    }

    /* PWA Install Prompt */
    .pwa-prompt {
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--bg-secondary);
      color: var(--text-primary);
      padding: 1rem 1.5rem;
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-xl);
      display: flex;
      align-items: center;
      gap: 1rem;
      z-index: 100;
      border: 1px solid var(--border);
      animation: slideUp 0.5s ease;
    }

    .pwa-prompt.hidden {
      display: none;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateX(-50%) translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
    }

    /* Responsive */
    @media (max-width: 992px) {
      :root {
        --sidebar-width: 240px;
      }
      
      .menu-toggle {
        display: flex;
      }
    }

    @media (max-width: 768px) {
      :root {
        --sidebar-width: 100%;
      }
      
      .dashboard-grid {
        grid-template-columns: 1fr;
      }
      
      .welcome-section {
        padding: 1.2rem;
      }
      
      .welcome-title {
        font-size: 1.3rem;
      }
      
      .card-body {
        padding: 1.2rem;
      }
      
      .timetable th, .timetable td {
        padding: 0.6rem;
        font-size: 0.9rem;
      }
      
      .homework-item {
        gap: 0.6rem;
      }
      
      .hw-title {
        font-size: 0.95rem;
      }
      
      .message {
        gap: 0.6rem;
      }
      
      .message-avatar {
        width: 32px;
        height: 32px;
        font-size: 0.8rem;
      }
      
      .ai-avatar {
        width: 40px;
        height: 40px;
        font-size: 1rem;
      }
      
      .ai-message {
        font-size: 0.9rem;
        padding: 0.8rem;
      }
      
      .ai-input input {
        padding: 0.7rem;
      }
      
      .ai-input button {
        width: 40px;
        height: 40px;
      }
      
      .quick-stats {
        gap: 0.5rem;
      }
      
      .stat-card {
        min-width: 140px;
      }
      
      .stat-value {
        font-size: 1.5rem;
      }
    }

    @media (max-width: 480px) {
      .header-actions {
        gap: 0.5rem;
      }
      
      .notification-btn, .profile-btn, .theme-toggle {
        width: 36px;
        height: 36px;
      }
      
      .menu-toggle {
        width: 36px;
        height: 36px;
      }
      
      .quick-stats {
        gap: 0.3rem;
      }
      
      .stat-card {
        min-width: 120px;
        padding: 0.8rem;
      }
      
      .stat-value {
        font-size: 1.3rem;
      }
      
      .stat-label {
        font-size: 0.8rem;
      }
      
      .filters {
        gap: 0.5rem;
      }
      
      .filter-btn {
        padding: 0.4rem 0.8rem;
        font-size: 0.8rem;
      }
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <h3>Dashboard</h3>
      <button class="sidebar-close">×</button>
    </div>
    <div class="sidebar-menu">
      <div class="sidebar-item active">
        <i>🏠</i>
        <span>Home</span>
      </div>
      <div class="sidebar-item">
        <i>📚</i>
        <span>Homework</span>
      </div>
      <div class="sidebar-item">
        <i>📅</i>
        <span>Timetable</span>
      </div>
      <div class="sidebar-item">
        <i>📊</i>
        <span>Progress</span>
      </div>
      <div class="sidebar-item">
        <i>👤</i>
        <span>Profile</span>
      </div>
      <div class="sidebar-item">
        <i>⚙️</i>
        <span>Settings</span>
      </div>
      <div class="sidebar-item">
        <i>❓</i>
        <span>Help & Support</span>
      </div>
      <div class="sidebar-item">
        <i>📤</i>
        <span>Logout</span>
      </div>
    </div>
  </aside>

  <!-- Header -->
  <header>
    <div class="header-left">
      <button class="menu-toggle">☰</button>
      <div class="logo-section">
        <img src="https://i.postimg.cc/ryGx49TB/erasebg-transformed.png" alt="Logo" class="logo" />
        <div class="school-title">MKPS Balrampur</div>
      </div>
    </div>
    <div class="header-actions">
      <button class="theme-toggle" id="theme-toggle">🌓</button>
      <button class="notification-btn" id="notification-btn">
        <i>🔔</i>
        <div class="notification-badge">3</div>
      </button>
      <button class="profile-btn" id="profile-btn">
        <i>👤</i>
      </button>
    </div>
  </header>

  <div class="container">
    <main>
      <!-- Welcome Section -->
      <section class="welcome-section">
        <h2 class="welcome-title">Welcome, <span id="student-name">Student</span>!</h2>
        <p class="welcome-subtitle">Class <span id="student-class">X</span> • Roll No: <span id="student-roll">123</span> • Last Login: <span id="last-login">Today</span></p>
      </section>

      <!-- Quick Stats -->
      <div class="quick-stats">
        <div class="stat-card">
          <div class="stat-value" id="homework-count">8</div>
          <div class="stat-label">Homework</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="attendance-percent">92%</div>
          <div class="stat-label">Attendance</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="tests-count">3</div>
          <div class="stat-label">Tests This Week</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="assignments-count">5</div>
          <div class="stat-label">Assignments</div>
        </div>
      </div>

      <!-- Dashboard Grid -->
      <div class="dashboard-grid">
        <!-- Timetable -->
        <div class="card">
          <div class="card-header">
            <div class="card-icon">📅</div>
            <h3 class="card-title">Today's Timetable</h3>
            <div class="card-header-actions">
              <button class="card-action-btn" title="Refresh">⟳</button>
              <button class="card-action-btn" title="View Full Schedule">⋯</button>
            </div>
          </div>
          <div class="card-body">
            <div class="filters">
              <button class="filter-btn active">Today</button>
              <button class="filter-btn">Tomorrow</button>
              <button class="filter-btn">This Week</button>
            </div>
            <table class="timetable">
              <thead>
                <tr>
                  <th>Time</th>
                  <th>Subject</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody id="timetable-body">
                <tr>
                  <td class="time">9:00 - 10:00</td>
                  <td class="subject">Hindi <span class="hw-priority priority-medium">Exercise</span></td>
                  <td><span class="class-status status-current">Current</span></td>
                </tr>
                <tr>
                  <td class="time">10:00 - 11:00</td>
                  <td class="subject">Mathematics <span class="hw-priority priority-high">Assignment</span></td>
                  <td><span class="class-status status-upcoming">Upcoming</span></td>
                </tr>
                <tr>
                  <td class="time">11:15 - 12:15</td>
                  <td class="subject">Science</td>
                  <td><span class="class-status status-upcoming">Upcoming</span></td>
                </tr>
                <tr>
                  <td class="time">12:15 - 1:15</td>
                  <td class="subject">English</td>
                  <td><span class="class-status status-upcoming">Upcoming</span></td>
                </tr>
                <tr>
                  <td class="time">2:00 - 3:00</td>
                  <td class="subject">Social Studies</td>
                  <td><span class="class-status status-upcoming">Upcoming</span></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Homework -->
        <div class="card">
          <div class="card-header">
            <div class="card-icon">📚</div>
            <h3 class="card-title">Homework</h3>
            <div class="card-header-actions">
              <button class="card-action-btn" title="Filter">☰</button>
              <button class="card-action-btn" title="Refresh">⟳</button>
            </div>
          </div>
          <div class="card-body">
            <div class="filters">
              <button class="filter-btn active">All</button>
              <button class="filter-btn">Due Today</button>
              <button class="filter-btn">High Priority</button>
              <button class="filter-btn">Completed</button>
            </div>
            <ul class="homework-list" id="homework-list">
              <li class="homework-item">
                <span class="hw-icon">📝</span>
                <div class="hw-content">
                  <div class="hw-title">Mathematics Assignment <span class="hw-priority priority-high">High</span></div>
                  <div class="hw-subject">Chapter 5: Fractions</div>
                  <div class="hw-date">Due: Tomorrow</div>
                </div>
              </li>
              <li class="homework-item">
                <span class="hw-icon">🎨</span>
                <div class="hw-content">
                  <div class="hw-title">Art Project <span class="hw-priority priority-medium">Medium</span></div>
                  <div class="hw-subject">Landscape Drawing</div>
                  <div class="hw-date">Due: Friday</div>
                </div>
              </li>
              <li class="homework-item">
                <span class="hw-icon">📖</span>
                <div class="hw-content">
                  <div class="hw-title">Reading Assignment <span class="hw-priority priority-low">Low</span></div>
                  <div class="hw-subject">English: Chapter 3</div>
                  <div class="hw-date">Due: Monday</div>
                </div>
              </li>
              <li class="homework-item">
                <span class="hw-icon">🔬</span>
                <div class="hw-content">
                  <div class="hw-title">Science Experiment <span class="hw-priority priority-high">High</span></div>
                  <div class="hw-subject">Chemical Reactions</div>
                  <div class="hw-date">Due: Wednesday</div>
                </div>
              </li>
            </ul>
          </div>
        </div>

        <!-- Upload Homework -->
        <div class="card">
          <div class="card-header">
            <div class="card-icon">📤</div>
            <h3 class="card-title">Upload Homework</h3>
            <div class="card-header-actions">
              <button class="card-action-btn" title="History">🕒</button>
            </div>
          </div>
          <div class="card-body">
            <div class="upload-area" id="upload-area">
              <div class="upload-icon">📁</div>
              <div class="upload-text">Click to upload your completed homework</div>
              <button class="upload-btn">Choose File</button>
              <input type="file" class="file-input" id="file-input" multiple>
            </div>
            <div class="upload-preview" id="upload-preview">
              <div class="preview-item">
                <span>📄</span>
                <div class="preview-name">math_assignment.pdf</div>
                <span class="preview-remove">×</span>
              </div>
              <div class="preview-item">
                <span>📄</span>
                <div class="preview-name">science_project.docx</div>
                <span class="preview-remove">×</span>
              </div>
              <button class="upload-btn" style="width: 100%; margin-top: 1rem;" id="submit-upload">Upload Files</button>
            </div>
          </div>
        </div>

        <!-- Messages -->
        <div class="card">
          <div class="card-header">
            <div class="card-icon">💬</div>
            <h3 class="card-title">Messages</h3>
            <div class="card-header-actions">
              <button class="card-action-btn" title="Mark All Read">✓</button>
              <button class="card-action-btn" title="Refresh">⟳</button>
            </div>
          </div>
          <div class="card-body">
            <div class="filters">
              <button class="filter-btn active">All</button>
              <button class="filter-btn">Unread</button>
              <button class="filter-btn">Important</button>
            </div>
            <div class="messages" id="messages-list">
              <div class="message message-unread">
                <div class="message-avatar">T</div>
                <div class="message-content">
                  <div class="message-sender">Teacher</div>
                  <div class="message-text">Don't forget to complete your mathematics assignment by tomorrow.</div>
                  <div class="message-time">10:30 AM</div>
                </div>
              </div>
              <div class="message">
                <div class="message-avatar">P</div>
                <div class="message-content">
                  <div class="message-sender">Principal</div>
                  <div class="message-text">School will be closed on Friday for Diwali celebrations.</div>
                  <div class="message-time">Yesterday</div>
                </div>
              </div>
              <div class="message">
                <div class="message-avatar">S</div>
                <div class="message-content">
                  <div class="message-sender">Student Council</div>
                  <div class="message-text">Science fair submissions due next week.</div>
                  <div class="message-time">Oct 18</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- AI Assistant -->
        <div class="card">
          <div class="card-header">
            <div class="card-icon">🤖</div>
            <h3 class="card-title">AI Assistant</h3>
            <div class="card-header-actions">
              <button class="card-action-btn" title="Clear Chat">🗑️</button>
            </div>
          </div>
          <div class="card-body ai-container">
            <div class="ai-avatar">AI</div>
            <div class="ai-message" id="ai-response">
              Hello! I'm your learning assistant. How can I help you with your studies today?
            </div>
            <div class="ai-input">
              <input type="text" placeholder="Ask me anything about your studies..." id="ai-input" />
              <button id="ai-send">➤</button>
            </div>
            <div style="margin-top: 0.5rem; font-size: 0.8rem; color: var(--text-tertiary); text-align: center;">
              AI responses are for guidance only
            </div>
          </div>
        </div>

        <!-- Calendar -->
        <div class="card">
          <div class="card-header">
            <div class="card-icon">🗓️</div>
            <h3 class="card-title">Calendar</h3>
            <div class="card-header-actions">
              <button class="card-action-btn" title="Add Event">+</button>
            </div>
          </div>
          <div class="card-body">
            <div class="calendar">
              <div class="calendar-header">
                <div class="calendar-nav">
                  <button class="calendar-nav-btn">❮</button>
                </div>
                October 2023
                <div class="calendar-nav">
                  <button class="calendar-nav-btn">❯</button>
                </div>
              </div>
              <div class="calendar-day">Sun</div>
              <div class="calendar-day">Mon</div>
              <div class="calendar-day">Tue</div>
              <div class="calendar-day">Wed</div>
              <div class="calendar-day">Thu</div>
              <div class="calendar-day">Fri</div>
              <div class="calendar-day">Sat</div>
              
              <div class="calendar-date past">1</div>
              <div class="calendar-date past">2</div>
              <div class="calendar-date past">3</div>
              <div class="calendar-date past">4</div>
              <div class="calendar-date past">5</div>
              <div class="calendar-date past">6</div>
              <div class="calendar-date past">7</div>
              
              <div class="calendar-date past">8</div>
              <div class="calendar-date past">9</div>
              <div class="calendar-date past">10</div>
              <div class="calendar-date past">11</div>
              <div class="calendar-date past">12</div>
              <div class="calendar-date past">13</div>
              <div class="calendar-date past">14</div>
              
              <div class="calendar-date past">15</div>
              <div class="calendar-date past">16</div>
              <div class="calendar-date past">17</div>
              <div class="calendar-date past">18</div>
              <div class="calendar-date past">19</div>
              <div class="calendar-date past">20</div>
              <div class="calendar-date today">21</div>
              
              <div class="calendar-date">22</div>
              <div class="calendar-date">23</div>
              <div class="calendar-date">24</div>
              <div class="calendar-date">25</div>
              <div class="calendar-date event">26</div>
              <div class="calendar-date">27</div>
              <div class="calendar-date">28</div>
              
              <div class="calendar-date">29</div>
              <div class="calendar-date">30</div>
              <div class="calendar-date">31</div>
              <div class="calendar-date"></div>
              <div class="calendar-date"></div>
              <div class="calendar-date"></div>
              <div class="calendar-date"></div>
            </div>
          </div>
        </div>

        <!-- Progress Chart -->
        <div class="card">
          <div class="card-header">
            <div class="card-icon">📈</div>
            <h3 class="card-title">Academic Progress</h3>
            <div class="card-header-actions">
              <button class="card-action-btn" title="Details">⋯</button>
            </div>
          </div>
          <div class="card-body">
            <div class="filters">
              <button class="filter-btn active">This Month</button>
              <button class="filter-btn">This Semester</button>
              <button class="filter-btn">All Time</button>
            </div>
            <div class="progress-container">
              <div class="progress-chart" id="progress-chart">
                <div class="progress-bar">
                  <div class="bar-fill" style="height: 80%"></div>
                  <div class="bar-value">80%</div>
                  <div class="bar-label">Math</div>
                </div>
                <div class="progress-bar">
                  <div class="bar-fill" style="height: 75%"></div>
                  <div class="bar-value">75%</div>
                  <div class="bar-label">Science</div>
                </div>
                <div class="progress-bar">
                  <div class="bar-fill" style="height: 85%"></div>
                  <div class="bar-value">85%</div>
                  <div class="bar-label">English</div>
                </div>
                <div class="progress-bar">
                  <div class="bar-fill" style="height: 70%"></div>
                  <div class="bar-value">70%</div>
                  <div class="bar-label">Hindi</div>
                </div>
                <div class="progress-bar">
                  <div class="bar-fill" style="height: 90%"></div>
                  <div class="bar-value">90%</div>
                  <div class="bar-label">Art</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Attendance -->
        <div class="card">
          <div class="card-header">
            <div class="card-icon">✅</div>
            <h3 class="card-title">Attendance</h3>
            <div class="card-header-actions">
              <button class="card-action-btn" title="Details">⋯</button>
            </div>
          </div>
          <div class="card-body">
            <div class="attendance-summary">
              <div class="attendance-stat">
                <div class="attendance-value">92%</div>
                <div class="attendance-label">Attendance</div>
              </div>
              <div class="attendance-stat">
                <div class="attendance-value" id="present-days">23</div>
                <div class="attendance-label">Present</div>
              </div>
              <div class="attendance-stat">
                <div class="attendance-value" id="absent-days">2</div>
                <div class="attendance-label">Absent</div>
              </div>
              <div class="attendance-stat">
                <div class="attendance-value" id="leave-days">1</div>
                <div class="attendance-label">On Leave</div>
              </div>
            </div>
            <div class="attendance-days">
              <div class="attendance-day present" title="Mon, Oct 16: Present">16</div>
              <div class="attendance-day present" title="Tue, Oct 17: Present">17</div>
              <div class="attendance-day present" title="Wed, Oct 18: Present">18</div>
              <div class="attendance-day present" title="Thu, Oct 19: Present">19</div>
              <div class="attendance-day present" title="Fri, Oct 20: Present">20</div>
              <div class="attendance-day present" title="Sat, Oct 21: Present">21</div>
              <div class="attendance-day weekend" title="Sun, Oct 22: Weekend">22</div>
            </div>
          </div>
        </div>

        <!-- Export Data -->
        <div class="card">
          <div class="card-header">
            <div class="card-icon">📊</div>
            <h3 class="card-title">Export Data</h3>
          </div>
          <div class="card-body">
            <div class="export-options">
              <button class="export-btn" id="export-pdf">
                <span class="export-icon">📄</span>
                <span>Export as PDF</span>
              </button>
              <button class="export-btn" id="export-excel">
                <span class="export-icon">📈</span>
                <span>Export as Excel</span>
              </button>
              <button class="export-btn" id="export-json">
                <span class="export-icon">💾</span>
                <span>Export as JSON</span>
              </button>
              <button class="export-btn" id="print-data">
                <span class="export-icon">🖨️</span>
                <span>Print Dashboard</span>
              </button>
            </div>
          </div>
        </div>

        <!-- Upcoming Events -->
        <div class="card">
          <div class="card-header">
            <div class="card-icon">🎉</div>
            <h3 class="card-title">Upcoming Events</h3>
          </div>
          <div class="card-body">
            <div class="homework-list">
              <li class="homework-item">
                <span class="hw-icon">🏆</span>
                <div class="hw-content">
                  <div class="hw-title">Science Fair</div>
                  <div class="hw-subject">Project Submission</div>
                  <div class="hw-date">Oct 26, 2023 • 10:00 AM</div>
                </div>
              </li>
              <li class="homework-item">
                <span class="hw-icon">🎨</span>
                <div class="hw-content">
                  <div class="hw-title">Art Exhibition</div>
                  <div class="hw-subject">Student Works Display</div>
                  <div class="hw-date">Nov 2, 2023 • 9:00 AM</div>
                </div>
              </li>
              <li class="homework-item">
                <span class="hw-icon">📚</span>
                <div class="hw-content">
                  <div class="hw-title">Mid-Term Exams</div>
                  <div class="hw-subject">All Subjects</div>
                  <div class="hw-date">Nov 15-20, 2023</div>
                </div>
              </li>
            </div>
          </div>
        </div>

        <!-- Notes & Resources -->
        <div class="card">
          <div class="card-header">
            <div class="card-icon">📖</div>
            <h3 class="card-title">Notes & Resources</h3>
          </div>
          <div class="card-body">
            <div class="homework-list">
              <li class="homework-item">
                <span class="hw-icon">📘</span>
                <div class="hw-content">
                  <div class="hw-title">Mathematics Notes</div>
                  <div class="hw-subject">Chapter 5: Fractions</div>
                  <div class="hw-date">Updated: Today</div>
                </div>
              </li>
              <li class="homework-item">
                <span class="hw-icon">🧪</span>
                <div class="hw-content">
                  <div class="hw-title">Science Lab Manual</div>
                  <div class="hw-subject">Chemical Reactions</div>
                  <div class="hw-date">Updated: Yesterday</div>
                </div>
              </li>
              <li class="homework-item">
                <span class="hw-icon">🎧</span>
                <div class="hw-content">
                  <div class="hw-title">English Audio</div>
                  <div class="hw-subject">Pronunciation Guide</div>
                  <div class="hw-date">Updated: Oct 18</div>
                </div>
              </li>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="card">
          <div class="card-header">
            <div class="card-icon">⚡</div>
            <h3 class="card-title">Quick Actions</h3>
          </div>
          <div class="card-body">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.8rem;">
              <button class="upload-btn" style="width: 100%; padding: 0.8rem;" id="quick-submit">
                📤 Submit Homework
              </button>
              <button class="upload-btn" style="width: 100%; padding: 0.8rem; background: #28a745;" id="quick-attendance">
                ✅ Mark Attendance
              </button>
              <button class="upload-btn" style="width: 100%; padding: 0.8rem; background: #fd7e14;" id="quick-message">
                💬 Send Message
              </button>
              <button class="upload-btn" style="width: 100%; padding: 0.8rem; background: #6f42c1;" id="quick-schedule">
                📅 View Schedule
              </button>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Bottom Navigation -->
  <nav class="bottom-nav">
    <div class="nav-item active">
      <i>🏠</i>
      <span>Home</span>
    </div>
    <div class="nav-item">
      <i>📚</i>
      <span>Homework</span>
    </div>
    <div class="nav-item">
      <i>💬</i>
      <span>Messages</span>
    </div>
    <div class="nav-item">
      <i>👤</i>
      <span>Profile</span>
    </div>
  </nav>

  <!-- PWA Install Prompt -->
  <div class="pwa-prompt hidden" id="pwa-prompt">
    <div>📥 Install our app for better experience!</div>
    <button style="background: var(--accent); color: white; border: none; padding: 0.5rem 1rem; border-radius: 8px;" id="install-button">Install</button>
  </div>

  <!-- Modals -->
  <div class="modal" id="homework-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Submit Homework</h3>
        <button class="modal-close">×</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">Select Subject</label>
          <select class="form-control" id="subject-select">
            <option value="math">Mathematics</option>
            <option value="science">Science</option>
            <option value="english">English</option>
            <option value="hindi">Hindi</option>
            <option value="sst">Social Studies</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Assignment Title</label>
          <input type="text" class="form-control" id="assignment-title" placeholder="Enter assignment title">
        </div>
        <div class="form-group">
          <label class="form-label">Upload Files</label>
          <div class="upload-area" style="margin: 0;">
            <div class="upload-icon">📁</div>
            <div class="upload-text">Click to upload files</div>
            <input type="file" class="file-input" id="modal-file-input" multiple>
          </div>
          <div class="upload-preview" id="modal-upload-preview"></div>
        </div>
        <div class="form-group">
          <label class="form-label">Additional Notes (Optional)</label>
          <textarea class="form-control" id="homework-notes" rows="3" placeholder="Add any additional information..."></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="cancel-homework">Cancel</button>
        <button class="btn btn-primary" id="submit-homework">Submit Homework</button>
      </div>
    </div>
  </div>

  <div class="modal" id="message-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Send Message</h3>
        <button class="modal-close">×</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">Recipient</label>
          <select class="form-control" id="recipient-select">
            <option value="teacher">Class Teacher</option>
            <option value="principal">Principal</option>
            <option value="parent">Parent Portal</option>
            <option value="admin">Administration</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Subject</label>
          <input type="text" class="form-control" id="message-subject" placeholder="Enter message subject">
        </div>
        <div class="form-group">
          <label class="form-label">Message</label>
          <textarea class="form-control" id="message-content" rows="5" placeholder="Type your message here..."></textarea>
        </div>
        <div class="form-group">
          <label class="form-label">Attach Files (Optional)</label>
          <div class="upload-area" style="margin: 0;">
            <div class="upload-icon">📁</div>
            <div class="upload-text">Click to attach files</div>
            <input type="file" class="file-input" id="message-file-input">
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="cancel-message">Cancel</button>
        <button class="btn btn-primary" id="send-message">Send Message</button>
      </div>
    </div>
  </div>

  <!-- Toast Notification -->
  <div class="toast" id="toast">Notification message</div>

  <!-- Shared Utilities from index.html -->
  <script>
    // Storage Utility with namespace
    const StorageUtil = {
      prefix: 'mkps_',
      set(key, value) {
        try {
          localStorage.setItem(this.prefix + key, JSON.stringify(value));
        } catch (e) {
          console.error('Storage error:', e);
        }
      },
      get(key) {
        try {
          const item = localStorage.getItem(this.prefix + key);
          return item ? JSON.parse(item) : null;
        } catch (e) {
          console.error('Storage error:', e);
          return null;
        }
      },
      remove(key) {
        localStorage.removeItem(this.prefix + key);
      }
    };

    // i18n Engine
    const i18n = {
      en: {
        welcome: 'Welcome',
        lastLogin: 'Last Login',
        today: 'Today',
        homework: 'Homework',
        upload: 'Upload',
        messages: 'Messages',
        aiAssistant: 'AI Assistant',
        calendar: 'Calendar',
        export: 'Export',
        installApp: 'Install our app for better experience!',
        install: 'Install',
        noHomework: 'No homework assigned',
        loading: 'Loading...',
        error: 'Error',
        success: 'Success',
        submitHomework: 'Submit Homework',
        attendance: 'Attendance',
        sendMessage: 'Send Message',
        viewSchedule: 'View Schedule',
        quickActions: 'Quick Actions',
        progress: 'Progress',
        notes: 'Notes',
        resources: 'Resources',
        events: 'Events',
        profile: 'Profile',
        settings: 'Settings',
        help: 'Help & Support',
        logout: 'Logout'
      },
      hi: {
        welcome: 'स्वागत है',
        lastLogin: 'अंतिम लॉगिन',
        today: 'आज',
        homework: 'गृहकार्य',
        upload: 'अपलोड करें',
        messages: 'संदेश',
        aiAssistant: 'एआई सहायक',
        calendar: 'कैलेंडर',
        export: 'निर्यात',
        installApp: 'बेहतर अनुभव के लिए हमारा ऐप स्थापित करें!',
        install: 'स्थापित करें',
        noHomework: 'कोई गृहकार्य निर्धारित नहीं है',
        loading: 'लोड हो रहा है...',
        error: 'त्रुटि',
        success: 'सफलता',
        submitHomework: 'गृहकार्य जमा करें',
        attendance: 'उपस्थिति',
        sendMessage: 'संदेश भेजें',
        viewSchedule: 'अनुसूची देखें',
        quickActions: 'त्वरित कार्य',
        progress: 'प्रगति',
        notes: 'नोट्स',
        resources: 'संसाधन',
        events: 'आयोजन',
        profile: 'प्रोफ़ाइल',
        settings: 'सेटिंग्स',
        help: 'सहायता',
        logout: 'लॉग आउट'
      }
    };

    // Current language
    let currentLang = 'en';

    // Date Utility
    const formatDate = (date) => {
      return new Date(date).toLocaleDateString(currentLang === 'hi' ? 'hi-IN' : 'en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      });
    };

    const formatTimeAgo = (timestamp) => {
      const now = new Date();
      const time = new Date(timestamp);
      const diffInHours = Math.floor((now - time) / (1000 * 60 * 60));
      
      if (diffInHours < 1) return 'Just now';
      if (diffInHours < 24) return `${diffInHours} hour${diffInHours > 1 ? 's' : ''} ago`;
      return formatDate(timestamp);
    };

    // Toast Notification System
    function showToast(message, type = 'success') {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.className = `toast ${type}`;
      toast.classList.add('show');

      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    // Modal System
    function openModal(modalId) {
      document.getElementById(modalId).classList.add('open');
    }

    function closeModal(modalId) {
      document.getElementById(modalId).classList.remove('open');
    }

    // Initialize Dashboard
    function initDashboard() {
      // Get current user
      const currentUser = StorageUtil.get('currentUser') || {
        name: 'John Doe',
        class: 'X',
        roll: '123',
        role: 'student',
        timestamp: Date.now()
      };

      // Set current language
      currentLang = StorageUtil.get('language') || 'en';

      // Update welcome section
      document.getElementById('student-name').textContent = currentUser.name;
      document.getElementById('student-class').textContent = currentUser.class;
      document.getElementById('student-roll').textContent = currentUser.roll;
      document.getElementById('last-login').textContent = formatTimeAgo(currentUser.timestamp);

      // Update timetable based on class
      updateTimetable(currentUser.class);

      // Load homework
      loadHomework(currentUser.class);

      // Update stats
      updateStats();

      // Check for PWA install
      checkPWAInstall();

      // Initialize theme
      initTheme();

      // Setup event listeners
      setupEventListeners();

      // Initialize AI assistant
      initAIAssistant();

      // Load attendance
      loadAttendance();

      // Initialize filters
      initFilters();
    }

    function updateTimetable(classLevel) {
      const timetableBody = document.getElementById('timetable-body');
      timetableBody.innerHTML = '';

      // Sample timetable data by class
      const timetableData = {
        'Nursery': [
          { time: '9:00 - 10:00', subject: 'Rhymes & Songs' },
          { time: '10:00 - 11:00', subject: 'Basic Shapes' },
          { time: '11:15 - 12:15', subject: 'Story Time' },
          { time: '12:15 - 1:15', subject: 'Drawing' },
          { time: '2:00 - 3:00', subject: 'Play Time' }
        ],
        '1': [
          { time: '9:00 - 10:00', subject: 'Hindi' },
          { time: '10:00 - 11:00', subject: 'Mathematics' },
          { time: '11:15 - 12:15', subject: 'English' },
          { time: '12:15 - 1:15', subject: 'EVS' },
          { time: '2:00 - 3:00', subject: 'Art & Craft' }
        ],
        '2': [
          { time: '9:00 - 10:00', subject: 'Hindi' },
          { time: '10:00 - 11:00', subject: 'Mathematics' },
          { time: '11:15 - 12:15', subject: 'English' },
          { time: '12:15 - 1:15', subject: 'EVS' },
          { time: '2:00 - 3:00', subject: 'Art & Craft' }
        ],
        '3': [
          { time: '9:00 - 10:00', subject: 'Hindi' },
          { time: '10:00 - 11:00', subject: 'Mathematics' },
          { time: '11:15 - 12:15', subject: 'English' },
          { time: '12:15 - 1:15', subject: 'EVS' },
          { time: '2:00 - 3:00', subject: 'Art' }
        ],
        '4': [
          { time: '9:00 - 10:00', subject: 'Hindi' },
          { time: '10:00 - 11:00', subject: 'Mathematics' },
          { time: '11:15 - 12:15', subject: 'English' },
          { time: '12:15 - 1:15', subject: 'Science' },
          { time: '2:00 - 3:00', subject: 'Social Studies' }
        ],
        '5': [
          { time: '9:00 - 10:00', subject: 'Hindi' },
          { time: '10:00 - 11:00', subject: 'Mathematics' },
          { time: '11:15 - 12:15', subject: 'English' },
          { time: '12:15 - 1:15', subject: 'Science' },
          { time: '2:00 - 3:00', subject: 'Social Studies' }
        ],
        '6': [
          { time: '9:00 - 10:00', subject: 'Hindi' },
          { time: '10:00 - 11:00', subject: 'Mathematics' },
          { time: '11:15 - 12:15', subject: 'English' },
          { time: '12:15 - 1:15', subject: 'Science' },
          { time: '2:00 - 3:00', subject: 'Social Studies' }
        ],
        '7': [
          { time: '9:00 - 10:00', subject: 'Hindi' },
          { time: '10:00 - 11:00', subject: 'Mathematics' },
          { time: '11:15 - 12:15', subject: 'English' },
          { time: '12:15 - 1:15', subject: 'Science' },
          { time: '2:00 - 3:00', subject: 'Social Studies' }
        ],
        '8': [
          { time: '9:00 - 10:00', subject: 'Hindi' },
          { time: '10:00 - 11:00', subject: 'Mathematics' },
          { time: '11:15 - 12:15', subject: 'English' },
          { time: '12:15 - 1:15', subject: 'Science' },
          { time: '2:00 - 3:00', subject: 'Social Studies' }
        ],
        '9': [
          { time: '9:00 - 10:00', subject: 'Hindi' },
          { time: '10:00 - 11:00', subject: 'Mathematics' },
          { time: '11:15 - 12:15', subject: 'English' },
          { time: '12:15 - 1:15', subject: 'Science' },
          { time: '2:00 - 3:00', subject: 'Social Studies' }
        ],
        '10': [
          { time: '9:00 - 10:00', subject: 'Hindi' },
          { time: '10:00 - 11:00', subject: 'Mathematics' },
          { time: '11:15 - 12:15', subject: 'English' },
          { time: '12:15 - 1:15', subject: 'Science' },
          { time: '2:00 - 3:00', subject: 'Social Studies' }
        ],
        '11': [
          { time: '9:00 - 10:00', subject: 'Physics' },
          { time: '10:00 - 11:00', subject: 'Chemistry' },
          { time: '11:15 - 12:15', subject: 'Mathematics' },
          { time: '12:15 - 1:15', subject: 'English' },
          { time: '2:00 - 3:00', subject: 'Computer Science' }
        ],
        '12': [
          { time: '9:00 - 10:00', subject: 'Physics' },
          { time: '10:00 - 11:00', subject: 'Chemistry' },
          { time: '11:15 - 12:15', subject: 'Mathematics' },
          { time: '12:15 - 1:15', subject: 'English' },
          { time: '2:00 - 3:00', subject: 'Computer Science' }
        ]
      };

      const data = timetableData[classLevel] || timetableData['10'];
      
      // Add status to current class
      const now = new Date();
      const currentHour = now.getHours();
      const currentMinute = now.getMinutes();
      const currentTime = currentHour * 60 + currentMinute;
      
      data.forEach((item, index) => {
        const [start, end] = item.time.split(' - ');
        const [startHour, startMin] = start.split(':').map(Number);
        const [endHour, endMin] = end.split(':').map(Number);
        
        const startTotal = startHour * 60 + startMin;
        const endTotal = endHour * 60 + endMin;
        
        let status = 'upcoming';
        if (currentTime >= startTotal && currentTime < endTotal) {
          status = 'current';
        }
        
        const row = document.createElement('tr');
        row.innerHTML = `
          <td class="time">${item.time}</td>
          <td class="subject">${item.subject}</td>
          <td><span class="class-status status-${status}">${status.charAt(0).toUpperCase() + status.slice(1)}</span></td>
        `;
        timetableBody.appendChild(row);
      });
    }

    function loadHomework(classLevel) {
      const homeworkList = document.getElementById('homework-list');
      homeworkList.innerHTML = '';

      // Sample homework data with priorities
      const homeworkData = {
        'Nursery': [
          { title: 'Color the picture', subject: 'Art & Craft', due: 'Tomorrow', priority: 'low' },
          { title: 'Learn rhymes', subject: 'Rhymes', due: 'Friday', priority: 'medium' }
        ],
        '1': [
          { title: 'Mathematics Worksheet', subject: 'Mathematics', due: 'Tomorrow', priority: 'high' },
          { title: 'Hindi Varnamala', subject: 'Hindi', due: 'Friday', priority: 'medium' },
          { title: 'English Alphabet', subject: 'English', due: 'Monday', priority: 'low' }
        ],
        '2': [
          { title: 'Mathematics Assignment', subject: 'Mathematics', due: 'Tomorrow', priority: 'high' },
          { title: 'Hindi Paragraph', subject: 'Hindi', due: 'Friday', priority: 'medium' },
          { title: 'English Story', subject: 'English', due: 'Monday', priority: 'low' }
        ],
        '3': [
          { title: 'Mathematics Problems', subject: 'Mathematics', due: 'Tomorrow', priority: 'high' },
          { title: 'Hindi Essay', subject: 'Hindi', due: 'Friday', priority: 'medium' },
          { title: 'English Composition', subject: 'English', due: 'Monday', priority: 'low' }
        ],
        '4': [
          { title: 'Mathematics Exercise', subject: 'Mathematics', due: 'Tomorrow', priority: 'high' },
          { title: 'Hindi Project', subject: 'Hindi', due: 'Friday', priority: 'medium' },
          { title: 'English Letter', subject: 'English', due: 'Monday', priority: 'low' }
        ],
        '5': [
          { title: 'Mathematics Assignment', subject: 'Mathematics', due: 'Tomorrow', priority: 'high' },
          { title: 'Science Project', subject: 'Science', due: 'Friday', priority: 'medium' },
          { title: 'English Essay', subject: 'English', due: 'Monday', priority: 'low' }
        ],
        '6': [
          { title: 'Mathematics Problems', subject: 'Mathematics', due: 'Tomorrow', priority: 'high' },
          { title: 'Science Experiment', subject: 'Science', due: 'Friday', priority: 'medium' },
          { title: 'English Composition', subject: 'English', due: 'Monday', priority: 'low' }
        ],
        '7': [
          { title: 'Mathematics Exercise', subject: 'Mathematics', due: 'Tomorrow', priority: 'high' },
          { title: 'Science Project', subject: 'Science', due: 'Friday', priority: 'medium' },
          { title: 'English Essay', subject: 'English', due: 'Monday', priority: 'low' }
        ],
        '8': [
          { title: 'Mathematics Assignment', subject: 'Mathematics', due: 'Tomorrow', priority: 'high' },
          { title: 'Science Experiment', subject: 'Science', due: 'Friday', priority: 'medium' },
          { title: 'English Composition', subject: 'English', due: 'Monday', priority: 'low' }
        ],
        '9': [
          { title: 'Mathematics Problems', subject: 'Mathematics', due: 'Tomorrow', priority: 'high' },
          { title: 'Science Project', subject: 'Science', due: 'Friday', priority: 'medium' },
          { title: 'English Essay', subject: 'English', due: 'Monday', priority: 'low' }
        ],
        '10': [
          { title: 'Mathematics Assignment', subject: 'Mathematics', due: 'Tomorrow', priority: 'high' },
          { title: 'Science Experiment', subject: 'Science', due: 'Friday', priority: 'medium' },
          { title: 'English Composition', subject: 'English', due: 'Monday', priority: 'low' }
        ],
        '11': [
          { title: 'Physics Problems', subject: 'Physics', due: 'Tomorrow', priority: 'high' },
          { title: 'Chemistry Lab Report', subject: 'Chemistry', due: 'Friday', priority: 'high' },
          { title: 'Mathematics Assignment', subject: 'Mathematics', due: 'Monday', priority: 'medium' }
        ],
        '12': [
          { title: 'Physics Project', subject: 'Physics', due: 'Tomorrow', priority: 'high' },
          { title: 'Chemistry Experiment', subject: 'Chemistry', due: 'Friday', priority: 'high' },
          { title: 'Mathematics Problems', subject: 'Mathematics', due: 'Monday', priority: 'medium' }
        ]
      };

      const data = homeworkData[classLevel] || homeworkData['10'];
      
      if (data.length === 0) {
        homeworkList.innerHTML = '<li class="homework-item empty-state"><div class="empty-icon">📝</div><div class="hw-content"><div class="hw-title">No homework assigned</div></div></li>';
        return;
      }

      data.forEach(item => {
        const li = document.createElement('li');
        li.className = 'homework-item';
        li.innerHTML = `
          <span class="hw-icon">📝</span>
          <div class="hw-content">
            <div class="hw-title">${item.title} <span class="hw-priority priority-${item.priority}">${item.priority.charAt(0).toUpperCase() + item.priority.slice(1)}</span></div>
            <div class="hw-subject">${item.subject}</div>
            <div class="hw-date">Due: ${item.due}</div>
          </div>
        `;
        homeworkList.appendChild(li);
      });
    }

    function updateStats() {
      // Update quick stats
      document.getElementById('homework-count').textContent = '8';
      document.getElementById('attendance-percent').textContent = '92%';
      document.getElementById('tests-count').textContent = '3';
      document.getElementById('assignments-count').textContent = '5';
    }

    function loadAttendance() {
      // Update attendance stats
      document.getElementById('present-days').textContent = '23';
      document.getElementById('absent-days').textContent = '2';
      document.getElementById('leave-days').textContent = '1';
    }

    function initAIAssistant() {
      const aiInput = document.getElementById('ai-input');
      const aiSend = document.getElementById('ai-send');
      const aiResponse = document.getElementById('ai-response');
      
      // Sample responses
      const responses = [
        'I can help you with your studies. What would you like to know?',
        'That\'s a great question! Let me explain that concept for you.',
        'I recommend reviewing your textbook for that topic. Would you like me to summarize it?',
        'You can find the answer in Chapter 3 of your Mathematics book.',
        'Let me help you solve that problem step by step.',
        'For your homework, focus on understanding the key concepts first.',
        'Remember to manage your time effectively for upcoming assignments.',
        'Your progress in Mathematics is improving. Keep up the good work!',
        'Would you like me to generate a study plan for your upcoming exams?'
      ];
      
      function handleAIQuery() {
        const query = aiInput.value.trim();
        
        if (!query) return;
        
        // Show thinking indicator
        aiResponse.textContent = 'Thinking...';
        
        // Simulate AI response with delay
        setTimeout(() => {
          const randomResponse = responses[Math.floor(Math.random() * responses.length)];
          aiResponse.textContent = randomResponse;
          aiInput.value = '';
        }, 800);
      }
      
      aiSend.addEventListener('click', handleAIQuery);
      aiInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          handleAIQuery();
        }
      });
    }

    function initFilters() {
      // Timetable filters
      document.querySelectorAll('.card:nth-child(1) .filter-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.card:nth-child(1) .filter-btn').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          showToast(`Showing ${this.textContent.toLowerCase()} timetable`, 'success');
        });
      });
      
      // Homework filters
      document.querySelectorAll('.card:nth-child(2) .filter-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.card:nth-child(2) .filter-btn').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          showToast(`Showing ${this.textContent.toLowerCase()} homework`, 'success');
        });
      });
      
      // Message filters
      document.querySelectorAll('.card:nth-child(4) .filter-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.card:nth-child(4) .filter-btn').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          showToast(`Showing ${this.textContent.toLowerCase()} messages`, 'success');
        });
      });
      
      // Progress filters
      document.querySelectorAll('.card:nth-child(7) .filter-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.card:nth-child(7) .filter-btn').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          showToast(`Showing ${this.textContent.toLowerCase()} progress`, 'success');
        });
      });
    }

    function initTheme() {
      const savedTheme = StorageUtil.get('theme') || 'light';
      document.documentElement.setAttribute('data-theme', savedTheme);
      
      const themeToggle = document.getElementById('theme-toggle');
      themeToggle.textContent = savedTheme === 'dark' ? '☀️' : '🌙';
    }

    function setupEventListeners() {
      // Theme toggle
      document.getElementById('theme-toggle').addEventListener('click', () => {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        
        document.documentElement.setAttribute('data-theme', newTheme);
        StorageUtil.set('theme', newTheme);
        
        document.getElementById('theme-toggle').textContent = newTheme === 'dark' ? '☀️' : '🌙';
        showToast(`Switched to ${newTheme} mode`, 'success');
      });

      // Menu toggle
      document.querySelector('.menu-toggle').addEventListener('click', () => {
        document.querySelector('.sidebar').classList.add('open');
        document.querySelector('main').classList.add('sidebar-open');
      });

      // Sidebar close
      document.querySelector('.sidebar-close').addEventListener('click', () => {
        document.querySelector('.sidebar').classList.remove('open');
        document.querySelector('main').classList.remove('sidebar-open');
      });

      // Sidebar items
      document.querySelectorAll('.sidebar-item').forEach((item, index) => {
        item.addEventListener('click', () => {
          document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
          item.classList.add('active');
          
          // Close sidebar on mobile
          if (window.innerWidth <= 768) {
            document.querySelector('.sidebar').classList.remove('open');
            document.querySelector('main').classList.remove('sidebar-open');
          }
          
          // Show toast for navigation
          const itemName = item.querySelector('span').textContent;
          showToast(`Navigating to ${itemName}`, 'success');
        });
      });

      // Notification button
      document.getElementById('notification-btn').addEventListener('click', () => {
        showToast('Loading notifications...', 'success');
      });

      // Profile button
      document.getElementById('profile-btn').addEventListener('click', () => {
        showToast('Opening profile...', 'success');
      });

      // Bottom nav
      document.querySelectorAll('.nav-item').forEach((item, index) => {
        item.addEventListener('click', () => {
          document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
          item.classList.add('active');
          
          const pages = ['index.html', 'dashboard.html', 'parent.html', 'teacher.html'];
          if (index === 0) return; // Already on home
          if (index === 1) showToast('Homework section', 'success');
          if (index === 2) showToast('Messages section', 'success');
          if (index === 3) showToast('Profile section', 'success');
        });
      });

      // Upload area
      const uploadArea = document.getElementById('upload-area');
      const fileInput = document.getElementById('file-input');
      const uploadPreview = document.getElementById('upload-preview');
      
      uploadArea.addEventListener('click', () => {
        fileInput.click();
      });
      
      fileInput.addEventListener('change', () => {
        if (fileInput.files.length > 0) {
          uploadPreview.innerHTML = '';
          for (let i = 0; i < fileInput.files.length; i++) {
            const file = fileInput.files[i];
            const previewItem = document.createElement('div');
            previewItem.className = 'preview-item';
            previewItem.innerHTML = `
              <span>📄</span>
              <div class="preview-name">${file.name}</div>
              <span class="preview-remove">×</span>
            `;
            uploadPreview.appendChild(previewItem);
          }
          uploadPreview.classList.add('active');
        }
      });
      
      // Remove file from preview
      uploadPreview.addEventListener('click', (e) => {
        if (e.target.classList.contains('preview-remove')) {
          const previewItem = e.target.parentElement;
          previewItem.remove();
          
          // If no files left, hide preview
          if (uploadPreview.children.length === 0) {
            uploadPreview.classList.remove('active');
          }
        }
      });
      
      // Submit upload
      document.getElementById('submit-upload').addEventListener('click', () => {
        const files = fileInput.files;
        if (files.length === 0) {
          showToast('Please select files to upload', 'warning');
          return;
        }
        
        showToast(`Uploading ${files.length} file(s)...`, 'success');
        
        // Simulate upload
        setTimeout(() => {
          showToast(`${files.length} file(s) uploaded successfully!`, 'success');
          uploadPreview.classList.remove('active');
          fileInput.value = '';
        }, 1500);
      });

      // PWA install
      document.getElementById('install-button').addEventListener('click', () => {
        showToast('App installed successfully!', 'success');
        document.getElementById('pwa-prompt').classList.add('hidden');
      });

      // Card action buttons
      document.querySelectorAll('.card-action-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.stopPropagation();
          const title = btn.parentElement.parentElement.querySelector('.card-title').textContent;
          showToast(`Action for ${title}`, 'success');
        });
      });

      // Homework item click
      document.querySelectorAll('.homework-item').forEach(item => {
        item.addEventListener('click', () => {
          const title = item.querySelector('.hw-title').textContent;
          showToast(`Viewing details for: ${title}`, 'success');
        });
      });

      // Message click
      document.querySelectorAll('.message').forEach(msg => {
        msg.addEventListener('click', () => {
          const sender = msg.querySelector('.message-sender').textContent;
          showToast(`Viewing message from: ${sender}`, 'success');
        });
      });

      // Calendar navigation
      document.querySelectorAll('.calendar-nav-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          showToast('Changing calendar month', 'success');
        });
      });

      // Calendar date click
      document.querySelectorAll('.calendar-date').forEach(date => {
        date.addEventListener('click', () => {
          if (date.textContent.trim() !== '') {
            showToast(`Selected date: ${date.textContent}`, 'success');
          }
        });
      });

      // Export buttons
      document.getElementById('export-pdf').addEventListener('click', () => {
        showToast('Exporting data as PDF...', 'success');
      });

      document.getElementById('export-excel').addEventListener('click', () => {
        showToast('Exporting data as Excel...', 'success');
      });

      document.getElementById('export-json').addEventListener('click', () => {
        showToast('Exporting data as JSON...', 'success');
      });

      document.getElementById('print-data').addEventListener('click', () => {
        showToast('Preparing print view...', 'success');
      });

      // Quick actions
      document.getElementById('quick-submit').addEventListener('click', () => {
        openModal('homework-modal');
      });

      document.getElementById('quick-attendance').addEventListener('click', () => {
        showToast('Attendance marked for today!', 'success');
      });

      document.getElementById('quick-message').addEventListener('click', () => {
        openModal('message-modal');
      });

      document.getElementById('quick-schedule').addEventListener('click', () => {
        showToast('Viewing full schedule...', 'success');
      });

      // Modal close buttons
      document.querySelectorAll('.modal-close').forEach(btn => {
        btn.addEventListener('click', () => {
          const modal = btn.closest('.modal');
          closeModal(modal.id);
        });
      });

      // Cancel homework submission
      document.getElementById('cancel-homework').addEventListener('click', () => {
        closeModal('homework-modal');
      });

      // Submit homework
      document.getElementById('submit-homework').addEventListener('click', () => {
        const title = document.getElementById('assignment-title').value;
        const files = document.getElementById('modal-file-input').files;
        
        if (!title) {
          showToast('Please enter an assignment title', 'warning');
          return;
        }
        
        if (files.length === 0) {
          showToast('Please select at least one file to upload', 'warning');
          return;
        }
        
        showToast(`Homework "${title}" submitted successfully!`, 'success');
        closeModal('homework-modal');
        
        // Reset form
        document.getElementById('subject-select').value = 'math';
        document.getElementById('assignment-title').value = '';
        document.getElementById('homework-notes').value = '';
        document.getElementById('modal-file-input').value = '';
        document.getElementById('modal-upload-preview').innerHTML = '';
      });

      // Cancel message
      document.getElementById('cancel-message').addEventListener('click', () => {
        closeModal('message-modal');
      });

      // Send message
      document.getElementById('send-message').addEventListener('click', () => {
        const subject = document.getElementById('message-subject').value;
        const content = document.getElementById('message-content').value;
        
        if (!subject) {
          showToast('Please enter a subject', 'warning');
          return;
        }
        
        if (!content) {
          showToast('Please enter a message', 'warning');
          return;
        }
        
        showToast('Message sent successfully!', 'success');
        closeModal('message-modal');
        
        // Reset form
        document.getElementById('recipient-select').value = 'teacher';
        document.getElementById('message-subject').value = '';
        document.getElementById('message-content').value = '';
        document.getElementById('message-file-input').value = '';
      });

      // Modal file input
      document.getElementById('modal-file-input').addEventListener('change', () => {
        const preview = document.getElementById('modal-upload-preview');
        preview.innerHTML = '';
        
        const files = document.getElementById('modal-file-input').files;
        for (let i = 0; i < files.length; i++) {
          const file = files[i];
          const previewItem = document.createElement('div');
          previewItem.className = 'preview-item';
          previewItem.innerHTML = `
            <span>📄</span>
            <div class="preview-name">${file.name}</div>
            <span class="preview-remove">×</span>
          `;
          preview.appendChild(previewItem);
        }
      });

      // Message file input
      document.getElementById('message-file-input').addEventListener('change', () => {
        showToast('File attached to message', 'success');
      });

      // Handle click outside modals
      document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('click', (e) => {
          if (e.target === modal) {
            closeModal(modal.id);
          }
        });
      });

      // Initialize today's date in calendar
      const today = new Date();
      const day = today.getDate();
      document.querySelector(`.calendar-date:nth-child(${day + 7})`).classList.add('today');
    }

    function checkPWAInstall() {
      // Simulate PWA install prompt after 3 seconds
      setTimeout(() => {
        document.getElementById('pwa-prompt').classList.remove('hidden');
      }, 3000);
    }

    // Initialize on load
    document.addEventListener('DOMContentLoaded', initDashboard);

    // Add resize listener for responsive behavior
    window.addEventListener('resize', () => {
      const sidebar = document.querySelector('.sidebar');
      const main = document.querySelector('main');
      
      if (window.innerWidth > 768) {
        sidebar.classList.remove('open');
        main.classList.remove('sidebar-open');
      }
    });
  </script>
</body>
</html>
