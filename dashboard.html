<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Milli Karwaan Public School | Dashboard</title>

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Google Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }

    body {
      min-height: 100vh;
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      color: #fff;
      overflow-x: hidden;
      position: relative;
    }

    /* Floating animated background circles */
    .circle {
      position: absolute;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.08);
      animation: float 12s infinite ease-in-out;
      z-index: 1;
    }

    .circle:nth-child(1) {
      width: 120px;
      height: 120px;
      top: 10%;
      left: 15%;
      animation-delay: 0s;
    }

    .circle:nth-child(2) {
      width: 200px;
      height: 200px;
      bottom: 10%;
      right: 10%;
      animation-delay: 3s;
    }

    .circle:nth-child(3) {
      width: 80px;
      height: 80px;
      bottom: 25%;
      left: 20%;
      animation-delay: 6s;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-30px); }
    }

    .dashboard {
      max-width: 100%;
      margin: 0 auto;
      padding: 1rem;
      z-index: 2;
      position: relative;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      padding: 1rem;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: linear-gradient(135deg, #00c6ff, #0072ff);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 1.2rem;
    }

    .user-details h3 {
      font-size: 1.1rem;
      font-weight: 600;
    }

    .user-details p {
      font-size: 0.8rem;
      opacity: 0.8;
    }

    .menu-btn {
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
    }

    .greeting {
      font-size: 1.4rem;
      margin-bottom: 1.5rem;
      font-weight: 600;
      background: linear-gradient(90deg, #00c6ff, #0072ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .stat-card {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      padding: 1rem;
      border-radius: 15px;
      text-align: center;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
      transition: transform 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-5px);
    }

    .stat-card i {
      font-size: 1.8rem;
      margin-bottom: 0.5rem;
      color: #00c6ff;
    }

    .stat-card .value {
      font-size: 1.4rem;
      font-weight: 700;
    }

    .stat-card .label {
      font-size: 0.8rem;
      opacity: 0.8;
    }

    .section {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 1.2rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .section-title {
      font-size: 1.1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .section-title i {
      color: #00c6ff;
    }

    .filter-buttons {
      display: flex;
      gap: 0.5rem;
    }

    .filter-btn {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      padding: 0.4rem 0.8rem;
      border-radius: 20px;
      font-size: 0.8rem;
      color: white;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .filter-btn.active {
      background: #00c6ff;
      color: #000;
    }

    .filter-btn:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .timetable {
      display: grid;
      grid-template-columns: 0.8fr 1fr;
      gap: 0.5rem;
      margin-top: 1rem;
    }

    .time-slot {
      font-size: 0.8rem;
      padding: 0.5rem;
      text-align: right;
      opacity: 0.8;
    }

    .subject {
      padding: 0.8rem;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      font-size: 0.9rem;
      position: relative;
      overflow: hidden;
    }

    .subject::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 4px;
      background: #00c6ff;
    }

    .subject .name {
      font-weight: 600;
    }

    .subject .teacher {
      font-size: 0.7rem;
      opacity: 0.8;
    }

    .homework-list, .announcement-list, .ai-suggestions {
      list-style: none;
    }

    .homework-item, .announcement-item, .ai-item {
      background: rgba(255, 255, 255, 0.1);
      margin-bottom: 0.8rem;
      padding: 1rem;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      position: relative;
      transition: all 0.3s ease;
    }

    .homework-item:hover, .announcement-item:hover, .ai-item:hover {
      transform: translateX(5px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
    }

    .homework-item .title, .announcement-item .title, .ai-item .title {
      font-weight: 600;
      margin-bottom: 0.3rem;
    }

    .homework-item .details, .announcement-item .details, .ai-item .details {
      font-size: 0.8rem;
      opacity: 0.8;
      margin-bottom: 0.5rem;
    }

    .homework-item .date, .announcement-item .date, .ai-item .date {
      font-size: 0.7rem;
      opacity: 0.6;
    }

    .homework-item .status {
      position: absolute;
      top: 1rem;
      right: 1rem;
      font-size: 0.7rem;
      padding: 0.2rem 0.5rem;
      border-radius: 10px;
      background: #ff9800;
    }

    .homework-item.completed .status {
      background: #4caf50;
    }

    .homework-item.overdue .status {
      background: #f44336;
    }

    .more-options {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      font-size: 1.2rem;
    }

    .ai-chat {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: linear-gradient(135deg, #00c6ff, #0072ff);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.5rem;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .ai-chat:hover {
      transform: scale(1.1);
      width: 55px;
      height: 55px;
    }

    .chat-container {
      position: fixed;
      bottom: 80px;
      right: 20px;
      width: 300px;
      max-width: 90vw;
      height: 400px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      overflow: hidden;
      z-index: 1000;
      display: none;
      animation: slideUp 0.3s ease;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .chat-header {
      padding: 1rem;
      background: rgba(0, 0, 0, 0.2);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .chat-header h4 {
      font-size: 0.9rem;
      font-weight: 600;
    }

    .close-chat {
      background: none;
      border: none;
      color: white;
      font-size: 1.2rem;
      cursor: pointer;
    }

    .chat-messages {
      height: 300px;
      overflow-y: auto;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .message {
      max-width: 80%;
      padding: 0.8rem;
      border-radius: 15px;
      font-size: 0.9rem;
      line-height: 1.4;
    }

    .ai-message {
      background: rgba(0, 198, 255, 0.2);
      align-self: flex-start;
      border-bottom-left-radius: 5px;
    }

    .user-message {
      background: rgba(255, 255, 255, 0.2);
      align-self: flex-end;
      border-bottom-right-radius: 5px;
    }

    .chat-input {
      display: flex;
      padding: 0.5rem;
      background: rgba(0, 0, 0, 0.2);
    }

    .chat-input input {
      flex: 1;
      padding: 0.5rem;
      border: none;
      border-radius: 20px;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      outline: none;
    }

    .chat-input input::placeholder {
      color: rgba(255, 255, 255, 0.6);
    }

    .chat-input button {
      background: #00c6ff;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-left: 0.5rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
    }

    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #4caf50;
      color: white;
      padding: 1rem;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      z-index: 2000;
      display: none;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(100%);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .help-btn {
      position: fixed;
      bottom: 90px;
      right: 20px;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: #4caf50;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.5rem;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 999;
    }

    .help-btn:hover {
      transform: scale(1.1);
      width: 55px;
      height: 55px;
    }

    .help-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .help-content {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      width: 90%;
      max-width: 400px;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .help-header {
      padding: 1rem;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 15px 15px 0 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .help-header h3 {
      font-size: 1.1rem;
      font-weight: 600;
    }

    .close-help {
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
    }

    .help-body {
      padding: 1.5rem;
    }

    .help-body textarea {
      width: 100%;
      height: 100px;
      padding: 1rem;
      border: none;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      resize: none;
      margin-bottom: 1rem;
      font-family: 'Poppins', sans-serif;
    }

    .help-body textarea::placeholder {
      color: rgba(255, 255, 255, 0.6);
    }

    .help-body button {
      background: linear-gradient(135deg, #00c6ff, #0072ff);
      color: white;
      border: none;
      padding: 0.8rem 1.5rem;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
    }

    /* Responsive adjustments */
    @media (max-width: 480px) {
      .header {
        padding: 0.8rem;
      }
      
      .user-info {
        gap: 0.8rem;
      }
      
      .user-details h3 {
        font-size: 1rem;
      }
      
      .greeting {
        font-size: 1.2rem;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
      
      .timetable {
        grid-template-columns: 0.7fr 1fr;
      }
      
      .time-slot {
        font-size: 0.7rem;
        padding: 0.4rem;
      }
      
      .subject {
        padding: 0.7rem;
      }
      
      .homework-item, .announcement-item, .ai-item {
        padding: 0.8rem;
      }
      
      .chat-container {
        width: 90vw;
        right: 5%;
        bottom: 80px;
      }
    }

    /* Animation for elements */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .animate-in {
      animation: fadeIn 0.6s ease forwards;
    }

    .delay-1 { animation-delay: 0.1s; }
    .delay-2 { animation-delay: 0.2s; }
    .delay-3 { animation-delay: 0.3s; }
    .delay-4 { animation-delay: 0.4s; }
    .delay-5 { animation-delay: 0.5s; }
    .delay-6 { animation-delay: 0.6s; }
  </style>
</head>
<body>
  <!-- Floating Background -->
  <div class="circle"></div>
  <div class="circle"></div>
  <div class="circle"></div>

  <div class="dashboard">
    <div class="header animate-in">
      <div class="user-info">
        <div class="avatar" id="userAvatar">U</div>
        <div class="user-details">
          <h3 id="userName">Loading...</h3>
          <p id="userClass">Class: --</p>
        </div>
      </div>
      <button class="menu-btn" id="themeToggle">🌗</button>
    </div>

    <div class="greeting animate-in delay-1">
      Good morning, <span id="greetingName">Student</span>! 👋
    </div>

    <div class="stats-grid animate-in delay-2">
      <div class="stat-card">
        <i class="material-icons">assignment</i>
        <div class="value" id="homeworkCount">0</div>
        <div class="label">Homework</div>
      </div>
      <div class="stat-card">
        <i class="material-icons">event</i>
        <div class="value" id="pendingCount">0</div>
        <div class="label">Pending</div>
      </div>
    </div>

    <div class="section animate-in delay-3">
      <div class="section-header">
        <h3 class="section-title"><i class="material-icons">schedule</i> Today's Timetable</h3>
      </div>
      <div class="timetable" id="timetable">
        <div class="time-slot">09:00</div>
        <div class="subject">
          <div class="name">Mathematics</div>
          <div class="teacher">Mr. Sharma</div>
        </div>
        <div class="time-slot">10:00</div>
        <div class="subject">
          <div class="name">English</div>
          <div class="teacher">Mrs. Patel</div>
        </div>
        <div class="time-slot">11:00</div>
        <div class="subject">
          <div class="name">Science</div>
          <div class="teacher">Mr. Kumar</div>
        </div>
        <div class="time-slot">12:00</div>
        <div class="subject">
          <div class="name">Break</div>
        </div>
        <div class="time-slot">13:00</div>
        <div class="subject">
          <div class="name">Hindi</div>
          <div class="teacher">Mrs. Singh</div>
        </div>
        <div class="time-slot">14:00</div>
        <div class="subject">
          <div class="name">Social Studies</div>
          <div class="teacher">Mr. Gupta</div>
        </div>
      </div>
    </div>

    <div class="section animate-in delay-4">
      <div class="section-header">
        <h3 class="section-title"><i class="material-icons">assignment</i> Homework</h3>
        <div class="filter-buttons">
          <button class="filter-btn active" data-filter="all">All</button>
          <button class="filter-btn" data-filter="pending">Pending</button>
          <button class="filter-btn" data-filter="completed">Completed</button>
        </div>
      </div>
      <ul class="homework-list" id="homeworkList">
        <!-- Homework items will be added here dynamically -->
      </ul>
    </div>

    <div class="section animate-in delay-5">
      <div class="section-header">
        <h3 class="section-title"><i class="material-icons">campaign</i> Announcements</h3>
      </div>
      <ul class="announcement-list" id="announcementList">
        <!-- Announcement items will be added here dynamically -->
      </ul>
    </div>

    <div class="section animate-in delay-6">
      <div class="section-header">
        <h3 class="section-title"><i class="material-icons">lightbulb</i> AI Study Tips</h3>
      </div>
      <ul class="ai-suggestions" id="aiSuggestions">
        <!-- AI suggestions will be added here dynamically -->
      </ul>
    </div>
  </div>

  <!-- AI Chat Button -->
  <div class="ai-chat" id="aiChatBtn">
    <i class="material-icons">smart_toy</i>
  </div>

  <!-- AI Chat Container -->
  <div class="chat-container" id="chatContainer">
    <div class="chat-header">
      <h4>AI Study Assistant</h4>
      <button class="close-chat" id="closeChat">×</button>
    </div>
    <div class="chat-messages" id="chatMessages">
      <div class="message ai-message">
        Hello! I'm your AI study assistant. How can I help you with your studies today?
      </div>
    </div>
    <div class="chat-input">
      <input type="text" id="chatInput" placeholder="Ask me anything about your studies...">
      <button id="sendChat"><i class="material-icons">send</i></button>
    </div>
  </div>

  <!-- Help Button -->
  <div class="help-btn" id="helpBtn">
    <i class="material-icons">help</i>
  </div>

  <!-- Help Modal -->
  <div class="help-modal" id="helpModal">
    <div class="help-content">
      <div class="help-header">
        <h3>Need Help?</h3>
        <button class="close-help" id="closeHelp">×</button>
      </div>
      <div class="help-body">
        <textarea id="helpMessage" placeholder="Describe your issue or question..."></textarea>
        <button id="sendHelp">Send Message</button>
      </div>
    </div>
  </div>

  <!-- Notification -->
  <div class="notification" id="notification">
    Message sent successfully!
  </div>

  <script>
    // Mock data for homework
    const homeworkData = [
      { id: 1, title: "Mathematics Assignment", subject: "Math", class: "6", details: "Complete exercises 1-10 on page 45", dueDate: "2023-06-15", status: "pending" },
      { id: 2, title: "English Essay", subject: "English", class: "6", details: "Write a 500-word essay on 'My Favorite Book'", dueDate: "2023-06-16", status: "pending" },
      { id: 3, title: "Science Project", subject: "Science", class: "6", details: "Prepare a model of the solar system", dueDate: "2023-06-20", status: "completed" },
      { id: 4, title: "Hindi Poem", subject: "Hindi", class: "6", details: "Learn and recite the poem 'Saraswati Vandana'", dueDate: "2023-06-14", status: "overdue" },
      { id: 5, title: "Social Studies Map", subject: "Social Studies", class: "6", details: "Draw and label the map of India with all states", dueDate: "2023-06-18", status: "pending" }
    ];

    // Mock data for announcements
    const announcementData = [
      { id: 1, title: "Annual Sports Day", details: "Annual Sports Day will be held on June 25th. All students are requested to participate.", date: "2023-06-10", priority: "high" },
      { id: 2, title: "Parent-Teacher Meeting", details: "Parent-Teacher meeting scheduled for June 22nd at 3:00 PM in the school auditorium.", date: "2023-06-08", priority: "medium" },
      { id: 3, title: "Library Hours Extended", details: "Library hours have been extended from 3:00 PM to 5:00 PM on weekdays.", date: "2023-06-05", priority: "low" }
    ];

    // Mock data for AI suggestions
    const aiSuggestionsData = [
      "Create a study schedule with short breaks every 25 minutes using the Pomodoro technique.",
      "Use flashcards to memorize vocabulary words and key concepts.",
      "Teach the material to someone else to reinforce your own understanding.",
      "Practice past exam papers to familiarize yourself with the question format.",
      "Stay hydrated and get enough sleep before exams for optimal brain function."
    ];

    // Timetable data based on class
    const timetableData = {
      "1": [
        { time: "09:00", subject: "Mathematics", teacher: "Ms. Gupta" },
        { time: "10:00", subject: "English", teacher: "Mr. Patel" },
        { time: "11:00", subject: "Drawing", teacher: "Mrs. Sharma" },
        { time: "12:00", subject: "Break" },
        { time: "13:00", subject: "Hindi", teacher: "Mr. Kumar" },
        { time: "14:00", subject: "Games", teacher: "Coach Singh" }
      ],
      "2": [
        { time: "09:00", subject: "Mathematics", teacher: "Ms. Gupta" },
        { time: "10:00", subject: "English", teacher: "Mr. Patel" },
        { time: "11:00", subject: "EVS", teacher: "Mrs. Sharma" },
        { time: "12:00", subject: "Break" },
        { time: "13:00", subject: "Hindi", teacher: "Mr. Kumar" },
        { time: "14:00", subject: "Art", teacher: "Mrs. Mehta" }
      ],
      "3": [
        { time: "09:00", subject: "Mathematics", teacher: "Mr. Sharma" },
        { time: "10:00", subject: "English", teacher: "Mrs. Patel" },
        { time: "11:00", subject: "EVS", teacher: "Mr. Kumar" },
        { time: "12:00", subject: "Break" },
        { time: "13:00", subject: "Hindi", teacher: "Mrs. Singh" },
        { time: "14:00", subject: "Computer", teacher: "Mr. Gupta" }
      ],
      "4": [
        { time: "09:00", subject: "Mathematics", teacher: "Mr. Sharma" },
        { time: "10:00", subject: "English", teacher: "Mrs. Patel" },
        { time: "11:00", subject: "Science", teacher: "Mr. Kumar" },
        { time: "12:00", subject: "Break" },
        { time: "13:00", subject: "Hindi", teacher: "Mrs. Singh" },
        { time: "14:00", subject: "Social Studies", teacher: "Mr. Gupta" }
      ],
      "5": [
        { time: "09:00", subject: "Mathematics", teacher: "Mr. Sharma" },
        { time: "10:00", subject: "English", teacher: "Mrs. Patel" },
        { time: "11:00", subject: "Science", teacher: "Mr. Kumar" },
        { time: "12:00", subject: "Break" },
        { time: "13:00", subject: "Hindi", teacher: "Mrs. Singh" },
        { time: "14:00", subject: "Social Studies", teacher: "Mr. Gupta" }
      ],
      "6": [
        { time: "09:00", subject: "Mathematics", teacher: "Mr. Sharma" },
        { time: "10:00", subject: "English", teacher: "Mrs. Patel" },
        { time: "11:00", subject: "Science", teacher: "Mr. Kumar" },
        { time: "12:00", subject: "Break" },
        { time: "13:00", subject: "Hindi", teacher: "Mrs. Singh" },
        { time: "14:00", subject: "Social Studies", teacher: "Mr. Gupta" }
      ],
      "7": [
        { time: "09:00", subject: "Mathematics", teacher: "Mr. Sharma" },
        { time: "10:00", subject: "English", teacher: "Mrs. Patel" },
        { time: "11:00", subject: "Science", teacher: "Mr. Kumar" },
        { time: "12:00", subject: "Break" },
        { time: "13:00", subject: "Hindi", teacher: "Mrs. Singh" },
        { time: "14:00", subject: "Social Studies", teacher: "Mr. Gupta" }
      ],
      "8": [
        { time: "09:00", subject: "Mathematics", teacher: "Mr. Sharma" },
        { time: "10:00", subject: "English", teacher: "Mrs. Patel" },
        { time: "11:00", subject: "Science", teacher: "Mr. Kumar" },
        { time: "12:00", subject: "Break" },
        { time: "13:00", subject: "Hindi", teacher: "Mrs. Singh" },
        { time: "14:00", subject: "Social Studies", teacher: "Mr. Gupta" }
      ]
    };

    // Gemini AI API configuration
    const GEMINI_API_KEY_1 = "AIzaSyCqGS8gb5kh7Jr0pv8d84LxCLhgHU-O_VU";
    const GEMINI_API_KEY_2 = "AIzaSyCdzFBQ1KVgBfmmjSgHJJwcuLbqne9VjUs";
    let currentGeminiKey = GEMINI_API_KEY_1;

    // Initialize the dashboard
    document.addEventListener('DOMContentLoaded', function() {
      // Check if user is logged in
      const studentData = JSON.parse(localStorage.getItem('mkps_student'));
      if (!studentData) {
        window.location.href = 'index.html';
        return;
      }

      // Display user information
      displayUserInfo(studentData);
      
      // Load data
      loadHomework(studentData.class);
      loadAnnouncements();
      loadTimetable(studentData.class);
      generateAISuggestions(studentData.class);
      
      // Set up event listeners
      setupEventListeners();
      
      // Show welcome notification
      showNotification(`Welcome back, ${studentData.name}!`);
    });

    function displayUserInfo(studentData) {
      const userNameEl = document.getElementById('userName');
      const userClassEl = document.getElementById('userClass');
      const userAvatarEl = document.getElementById('userAvatar');
      const greetingNameEl = document.getElementById('greetingName');
      
      userNameEl.textContent = studentData.name;
      userClassEl.textContent = `Class: ${studentData.class}`;
      greetingNameEl.textContent = studentData.name.split(' ')[0];
      
      // Set avatar initial
      userAvatarEl.textContent = studentData.name.charAt(0).toUpperCase();
    }

    function loadHomework(classLevel) {
      const homeworkList = document.getElementById('homeworkList');
      const filteredHomework = homeworkData.filter(hw => hw.class === classLevel);
      
      // Update counts
      const pendingCount = filteredHomework.filter(hw => hw.status === 'pending').length;
      const homeworkCount = filteredHomework.length;
      
      document.getElementById('pendingCount').textContent = pendingCount;
      document.getElementById('homeworkCount').textContent = homeworkCount;
      
      // Clear existing list
      homeworkList.innerHTML = '';
      
      // Add homework items
      filteredHomework.forEach(hw => {
        const li = document.createElement('li');
        li.className = `homework-item ${hw.status}`;
        li.innerHTML = `
          <div class="title">${hw.title}</div>
          <div class="details">${hw.details}</div>
          <div class="date">Due: ${formatDate(hw.dueDate)}</div>
          <span class="status">${hw.status.charAt(0).toUpperCase() + hw.status.slice(1)}</span>
          <button class="more-options"><i class="material-icons">more_vert</i></button>
        `;
        homeworkList.appendChild(li);
      });
    }

    function loadAnnouncements() {
      const announcementList = document.getElementById('announcementList');
      
      // Clear existing list
      announcementList.innerHTML = '';
      
      // Add announcement items
      announcementData.forEach(ann => {
        const li = document.createElement('li');
        li.className = 'announcement-item';
        li.innerHTML = `
          <div class="title">${ann.title}</div>
          <div class="details">${ann.details}</div>
          <div class="date">${ann.date}</div>
        `;
        announcementList.appendChild(li);
      });
    }

    function loadTimetable(classLevel) {
      const timetable = document.getElementById('timetable');
      const classTimetable = timetableData[classLevel] || timetableData['6'];
      
      // Clear existing timetable
      timetable.innerHTML = '';
      
      // Add timetable items
      classTimetable.forEach(slot => {
        const timeSlot = document.createElement('div');
        timeSlot.className = 'time-slot';
        timeSlot.textContent = slot.time;
        
        const subject = document.createElement('div');
        subject.className = 'subject';
        if (slot.subject !== 'Break') {
          subject.innerHTML = `
            <div class="name">${slot.subject}</div>
            <div class="teacher">${slot.teacher}</div>
          `;
        } else {
          subject.innerHTML = `<div class="name">${slot.subject}</div>`;
        }
        
        timetable.appendChild(timeSlot);
        timetable.appendChild(subject);
      });
    }

    function generateAISuggestions(classLevel) {
      const aiSuggestions = document.getElementById('aiSuggestions');
      
      // Clear existing suggestions
      aiSuggestions.innerHTML = '';
      
      // Add AI suggestions
      const relevantSuggestions = aiSuggestionsData.slice(0, 3);
      relevantSuggestions.forEach(suggestion => {
        const li = document.createElement('li');
        li.className = 'ai-item';
        li.innerHTML = `
          <div class="title">Study Tip</div>
          <div class="details">${suggestion}</div>
          <div class="date">AI Generated</div>
        `;
        aiSuggestions.appendChild(li);
      });
    }

    function setupEventListeners() {
      // Theme toggle
      document.getElementById('themeToggle').addEventListener('click', toggleTheme);
      
      // Filter buttons for homework
      const filterButtons = document.querySelectorAll('.filter-btn');
      filterButtons.forEach(btn => {
        btn.addEventListener('click', function() {
          // Remove active class from all buttons
          filterButtons.forEach(b => b.classList.remove('active'));
          // Add active class to clicked button
          this.classList.add('active');
          
          // Filter homework (implementation would go here)
          const filter = this.getAttribute('data-filter');
          console.log(`Filtering homework: ${filter}`);
        });
      });
      
      // AI Chat functionality
      const aiChatBtn = document.getElementById('aiChatBtn');
      const chatContainer = document.getElementById('chatContainer');
      const closeChat = document.getElementById('closeChat');
      const chatInput = document.getElementById('chatInput');
      const sendChat = document.getElementById('sendChat');
      
      aiChatBtn.addEventListener('click', () => {
        chatContainer.style.display = 'flex';
      });
      
      closeChat.addEventListener('click', () => {
        chatContainer.style.display = 'none';
      });
      
      sendChat.addEventListener('click', sendMessage);
      chatInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          sendMessage();
        }
      });
      
      // Help button functionality
      const helpBtn = document.getElementById('helpBtn');
      const helpModal = document.getElementById('helpModal');
      const closeHelp = document.getElementById('closeHelp');
      const sendHelp = document.getElementById('sendHelp');
      
      helpBtn.addEventListener('click', () => {
        helpModal.style.display = 'flex';
      });
      
      closeHelp.addEventListener('click', () => {
        helpModal.style.display = 'none';
      });
      
      sendHelp.addEventListener('click', sendHelpMessage);
    }

    function toggleTheme() {
      document.body.classList.toggle('light');
      const themeToggle = document.getElementById('themeToggle');
      
      if (document.body.classList.contains('light')) {
        document.body.style.background = 'linear-gradient(135deg, #f5f7fa, #c3cfe2)';
        document.body.style.color = '#000';
        themeToggle.textContent = '🌙';
      } else {
        document.body.style.background = 'linear-gradient(135deg, #0f2027, #203a43, #2c5364)';
        document.body.style.color = '#fff';
        themeToggle.textContent = '🌗';
      }
    }

    function sendMessage() {
      const chatInput = document.getElementById('chatInput');
      const chatMessages = document.getElementById('chatMessages');
      
      const message = chatInput.value.trim();
      if (!message) return;
      
      // Add user message
      const userMsg = document.createElement('div');
      userMsg.className = 'message user-message';
      userMsg.textContent = message;
      chatMessages.appendChild(userMsg);
      
      // Clear input
      chatInput.value = '';
      
      // Scroll to bottom
      chatMessages.scrollTop = chatMessages.scrollHeight;
      
      // Simulate AI response (would normally call Gemini API)
      setTimeout(() => {
        const aiMsg = document.createElement('div');
        aiMsg.className = 'message ai-message';
        
        // Simple response logic
        if (message.toLowerCase().includes('homework')) {
          aiMsg.textContent = "I can help you with your homework! What subject are you working on?";
        } else if (message.toLowerCase().includes('math')) {
          aiMsg.textContent = "Math is all about practice. Try breaking down problems into smaller steps and work through them systematically.";
        } else if (message.toLowerCase().includes('science')) {
          aiMsg.textContent = "For science, make sure to understand the concepts rather than just memorizing facts. Creating diagrams can help visualize complex ideas.";
        } else if (message.toLowerCase().includes('english')) {
          aiMsg.textContent = "Reading regularly improves your English skills. Try to read for at least 20 minutes every day and note down new words you learn.";
        } else {
          aiMsg.textContent = "That's an interesting question! As your AI study assistant, I'm here to help you with any academic challenges you're facing.";
        }
        
        chatMessages.appendChild(aiMsg);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }, 1000);
    }

    function sendHelpMessage() {
      const helpMessage = document.getElementById('helpMessage');
      const message = helpMessage.value.trim();
      
      if (!message) {
        showNotification('Please enter a message');
        return;
      }
      
      // In a real app, this would send to admin
      console.log('Help message sent:', message);
      
      // Clear and close
      helpMessage.value = '';
      document.getElementById('helpModal').style.display = 'none';
      
      // Show confirmation
      showNotification('Your message has been sent to the admin');
    }

    function showNotification(message) {
      const notification = document.getElementById('notification');
      notification.textContent = message;
      notification.style.display = 'block';
      
      setTimeout(() => {
        notification.style.display = 'none';
      }, 3000);
    }

    function formatDate(dateString) {
      const options = { year: 'numeric', month: 'short', day: 'numeric' };
      return new Date(dateString).toLocaleDateString(undefined, options);
    }

    // Add event listener for the more options buttons (using event delegation)
    document.addEventListener('click', function(e) {
      if (e.target.closest('.more-options')) {
        const homeworkItem = e.target.closest('.homework-item');
        const status = homeworkItem.classList.contains('completed') ? 'pending' : 'completed';
        
        // Toggle status
        if (status === 'completed') {
          homeworkItem.classList.remove('pending');
          homeworkItem.classList.remove('overdue');
          homeworkItem.classList.add('completed');
          homeworkItem.querySelector('.status').textContent = 'Completed';
          homeworkItem.querySelector('.status').style.background = '#4caf50';
        } else {
          homeworkItem.classList.remove('completed');
          homeworkItem.classList.add('pending');
          homeworkItem.querySelector('.status').textContent = 'Pending';
          homeworkItem.querySelector('.status').style.background = '#ff9800';
        }
        
        showNotification(`Homework marked as ${status}`);
      }
    });

    // Check for overdue homework
    function checkOverdueHomework() {
      const today = new Date().toISOString().split('T')[0];
      const overdueItems = document.querySelectorAll('.homework-item.pending');
      
      overdueItems.forEach(item => {
        const dueDate = item.querySelector('.date').textContent.replace('Due: ', '');
        if (dueDate < today) {
          item.classList.remove('pending');
          item.classList.add('overdue');
          item.querySelector('.status').textContent = 'Overdue';
          item.querySelector('.status').style.background = '#f44336';
        }
      });
    }

    // Run overdue check
    checkOverdueHomework();

    // Periodic check for overdue items (every hour)
    setInterval(checkOverdueHomework, 60 * 60 * 1000);
  </script>
</body>
</html>
