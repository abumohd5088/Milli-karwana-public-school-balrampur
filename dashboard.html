<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Dashboard | School Web #1</title>
    <meta name="description" content="Official school dashboard ‚Äì homework, AI assistant, notifications, offline ready.">
    <meta name="theme-color" content="#0d6efd">
    <link rel="manifest" href="data:application/json,{"name":"School Dashboard","short_name":"Dashboard","icons":[{"src":"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Ctext y='50%25' x='50%25' dominant-baseline='middle' text-anchor='middle' font-size='300'%3Eüè´%3C/text%3E%3C/svg%3E","sizes":"512x512","type":"image/svg+xml"}],"start_url":"/dashboard.html","display":"standalone","background_color":"#0d6efd","theme_color":"#0d6efd"}">
    <style>
        :root{
            --primary:#0d6efd;
            --secondary:#6c757d;
            --light:#f8f9fa;
            --dark:#212529;
            --accent:#ffc107;
            --bg:#ffffff;
            --card:#f8f3ff;
            --shadow:0 2px 8px rgba(0,0,0,.1);
            --radius:12px;
            --font:'Poppins',sans-serif;
        }
        .dark{
            --bg:#121212;
            --card:#1e1e1e;
            --light:#212529;
            --dark:#f1f3f5;
        }
        *{margin:0;padding:0;box-sizing:border-box;font-family:var(--font);}
        body{background:var(--bg);color:var(--dark);transition:.3s}
        .navbar{display:flex;justify-content:space-between;align-items:center;background:var(--primary);color:#fff;padding:12px 20px;font-weight:600}
        .menu-btn{background:none;border:none;color:#fff;font-size:1.4em;cursor:pointer}
        .side-panel{position:fixed;top:0;right:-250px;width:250px;height:100%;background:var(--card);box-shadow:var(--shadow);transition:right .3s;z-index:999;padding:15px;color:var(--dark)}
        .side-panel.open{right:0}
        .overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.4);display:none;z-index:998}
        .overlay.open{display:block}
        .side-panel ul{list-style:none;margin-top:20px}
        .side-panel li{margin:15px 0}
        .side-panel a{color:var(--dark);text-decoration:none;font-weight:600}
        .container{padding:15px;max-width:700px;margin:auto}
        .card{background:var(--card);border-radius:var(--radius);padding:15px;margin-bottom:15px;box-shadow:var(--shadow)}
        h2{font-size:1.25em;margin-bottom:10px}
        .btn{background:var(--primary);color:#fff;border:none;padding:10px 15px;border-radius:var(--radius);font-weight:600;width:100%;cursor:pointer;margin-top:8px}
        .btn:hover{background:#084298}
        .chatBox{height:200px;overflow-y:auto;border:1px solid #ccc;border-radius:var(--radius);padding:8px;background:#fff;color:#000;font-size:.85em;margin-bottom:8px}
        .chatInput{display:flex;gap:5px}
        .chatInput input{flex:1;padding:8px;border:1px solid #ccc;border-radius:var(--radius)}
        .chatInput button{padding:8px 12px;background:var(--primary);color:#fff;border:none;border-radius:var(--radius);font-weight:bold}
        .hw-list li{margin:8px 0}
        .notify{position:fixed;top:10px;right:10px;background:var(--accent);color:#000;padding:10px;border-radius:var(--radius);display:none;z-index:1001}
        footer{text-align:center;padding:15px;background:var(--light);color:var(--secondary);font-size:.8em;margin-top:30px}
        @media(max-width:500px){.navbar{font-size:1em}}
    </style>
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar">
    <span>üè´ Dashboard ‚Äì Class <span id="clsSpan"></span></span>
    <button class="menu-btn" onclick="toggleMenu()">‚ãÆ</button>
</nav>

<!-- SIDE MENU -->
<div class="overlay" id="overlay" onclick="toggleMenu()"></div>
<div class="side-panel" id="sidePanel">
    <h3>Menu</h3>
    <ul>
        <li><a href="#" onclick="printPage()">üñ®Ô∏è Print</a></li>
        <li><a href="#" onclick="sharePage()">üì§ Share</a></li>
        <li><a href="#" onclick="toggleDark()">üåó Dark Mode</a></li>
        <li><a href="#" onclick="logout()">üö™ Logout</a></li>
        <li><a href="admin.html">üîê Admin Panel</a></li>
    </ul>
</div>

<div class="container">
    <!-- Welcome -->
    <div class="card">
        <h2>Hi <span id="nameSpan"></span> üëã</h2>
    </div>

    <!-- Homework -->
    <div class="card">
        <h2>üìö Homework</h2>
        <ul id="hwList" class="hw-list"></ul>
        <button class="btn" onclick="addHW()">Add New Homework</button>
    </div>

    <!-- AI -->
    <div class="card">
        <h2>ü§ñ AI Homework Helper</h2>
        <div class="chatBox" id="chatBox"></div>
        <div class="chatInput">
            <input id="chatIn" placeholder="Ask about homework‚Ä¶"/>
            <button onclick="askAI()">Send</button>
        </div>
    </div>

    <!-- Offline -->
    <div id="offlineMsg" class="card hidden">
        <p>‚ö†Ô∏è You are offline. Data may be outdated.</p>
    </div>
</div>

<!-- NOTIFICATION -->
<div id="notify" class="notify"></div>

<footer>¬© 2025 School Web #1 ‚Äì Professional & Mobile Ready</footer>

<script>
/* ---------- CONFIG ---------- */
const API_KEY = "AIzaSyCdzFBQ1KVgBfmmjSgHJJwcuLbqne9VjUs";
const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`;

/* ---------- AUTH ---------- */
if(!localStorage.getItem('name')) location.href='index.html';
const cls = localStorage.getItem('cls');
const name = localStorage.getItem('name');
document.getElementById('clsSpan').innerText = cls;
document.getElementById('nameSpan').innerText = name;

/* ---------- MENU ---------- */
function toggleMenu(){
    document.getElementById('sidePanel').classList.toggle('open');
    document.getElementById('overlay').classList.toggle('open');
}

/* ---------- DARK MODE ---------- */
function toggleDark(){
    document.body.classList.toggle('dark');
    localStorage.setItem('dark',document.body.classList.contains('dark'));
    showToast('Theme changed');
}
if(localStorage.getItem('dark')==='true') document.body.classList.add('dark');

/* ---------- NOTIFICATION ---------- */
function showToast(msg){
    const el=document.getElementById('notify');
    el.innerText=msg;
    el.style.display='block';
    setTimeout(()=>el.style.display='none',2000);
}

/* ---------- PRINT & SHARE ---------- */
function printPage(){ window.print(); }
function sharePage(){
    if(navigator.share){
        navigator.share({title:'School Dashboard',url:location.href});
    }else{
        showToast('Sharing not supported');
    }
}

/* ---------- HOMEWORK ---------- */
const homeworkDB = {
    "1": ["Math ‚Äì Count 1-50", "English ‚Äì A-Z writing", "Art ‚Äì Colour apple"],
    "2": ["Math ‚Äì Tables 2-5", "EVS ‚Äì My Family", "Hindi ‚Äì Varnamala"],
    "3": ["Math ‚Äì Addition 3-digit", "English ‚Äì Story reading", "Science ‚Äì Body parts"],
    "4": ["Math ‚Äì Long division", "Science ‚Äì Plant diagram", "SST ‚Äì Our country"],
    "5": ["Math ‚Äì Fraction basics", "English ‚Äì Paragraph", "EVS ‚Äì Water cycle"],
    "6": ["Math ‚Äì Algebra intro", "Science ‚Äì Light", "History ‚Äì Ancient India"],
    "7": ["Math ‚Äì Simple equations", "History ‚Äì Delhi Sultanate", "Geography ‚Äì Atmosphere"],
    "8": ["Math ‚Äì Rational numbers", "Physics ‚Äì Force & pressure", "Chemistry ‚Äì Metals"],
    "9": ["Math ‚Äì Polynomials", "Chemistry ‚Äì Matter", "Physics ‚Äì Motion"],
    "10": ["Math ‚Äì Quadratic equations", "Physics ‚Äì Electricity", "Chemistry ‚Äì Acids"],
    "11": ["Math ‚Äì Sets", "Chemistry ‚Äì Mole concept", "Physics ‚Äì Units"],
    "12": ["Math ‚Äì Relations", "Physics ‚Äì Electrostatics", "Chemistry ‚Äì Solutions"]
};
document.getElementById('hwList').innerHTML = homeworkDB[cls].map(hw=>`<li>${hw}</li>`).join('');

function addHW(){
    const task=prompt('Enter homework:');
    if(task){
        const li=document.createElement('li');
        li.innerText=task;
        document.getElementById('hwList').appendChild(li);
        showToast('Added');
    }
}

/* ---------- AI HOMEWORK ONLY ---------- */
async function askAI(){
    const msg=document.getElementById('chatIn').value.trim();
    if(!msg) return;
    const box=document.getElementById('chatBox');
    box.innerHTML+=`<div><b>You:</b> ${msg}</div>`;
    document.getElementById('chatIn').value='';
    const prompt=`You are a school assistant. The student is in class ${cls}. Only answer about homework or school-related topics. Question: ${msg}`;
    try{
        const res=await fetch(API_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({contents:[{parts:[{text:prompt}]}]})});
        const data=await res.json();
        const reply=data.candidates?.[0]?.content?.parts?.[0]?.text||'‚ö†Ô∏è Please ask homework-related questions only.';
        box.innerHTML+=`<div><b>AI:</b> ${reply}</div>`;
        box.scrollTop=box.scrollHeight;
    }catch(e){
        box.innerHTML+=`<div><b>Error:</b> Check internet</div>`;
    }
}

/* ---------- OFFLINE CHECK ---------- */
window.addEventListener('online',()=>{document.getElementById('offlineMsg').classList.add('hidden')});
window.addEventListener('offline',()=>{document.getElementById('offlineMsg').classList.remove('hidden')});

/* ---------- LOGOUT ---------- */
function logout(){
    localStorage.clear();
    location.href='index.html';
}
</script>
</body>
</html>
