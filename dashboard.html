<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Dashboard - Springfield India</title>
    <link rel="stylesheet" href="css/ultra-pro.css">
    <link rel="icon" href="images/favicon.ico">
    <meta name="theme-color" content="#667eea">
</head>
<body>
    <!-- Status Bar -->
    <div class="status-bar">
        <div class="status-time" id="statusTime">12:00</div>
        <div class="status-battery">🔋100%</div>
    </div>

    <!-- Header -->
    <header class="dashboard-header">
        <div class="header-content">
            <div class="header-left">
                <img src="images/logo.png" alt="Logo" class="header-logo">
                <div>
                    <h1 id="welcomeText">Welcome</h1>
                    <p id="classText">Class</p>
                </div>
            </div>
            <div class="header-right">
                <button class="notification-btn" onclick="showNotifications()">
                    <span>🔔</span>
                    <span class="notification-count">3</span>
                </button>
                <button class="profile-btn" onclick="showProfile()">
                    <span>👤</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Quick Stats -->
    <div class="quick-stats">
        <div class="stat-item" onclick="scrollToSection('homework')">
            <div class="stat-icon">📝</div>
            <div class="stat-number" id="hwCount">0</div>
            <div class="stat-label">Homework</div>
        </div>
        <div class="stat-item" onclick="scrollToSection('notes')">
            <div class="stat-icon">📖</div>
            <div class="stat-number" id="notesCount">0</div>
            <div class="stat-label">Notes</div>
        </div>
        <div class="stat-item" onclick="scrollToSection('results')">
            <div class="stat-icon">📊</div>
            <div class="stat-number" id="resultsCount">0</div>
            <div class="stat-label">Results</div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="dashboard-main">
        <!-- Homework Section -->
        <section class="content-section" id="homework">
            <div class="section-header">
                <h2>Today's Homework 📚</h2>
                <button class="refresh-btn" onclick="refreshHomework()">
                    <span>🔄</span>
                </button>
            </div>
            <div class="cards-container" id="homeworkCards"></div>
            <div class="empty-state" id="homeworkEmpty" style="display: none;">
                <div class="empty-icon">📚</div>
                <h3>No Homework Today!</h3>
                <p>Enjoy your free time 🎉</p>
            </div>
        </section>

        <!-- Notes Section -->
        <section class="content-section" id="notes">
            <div class="section-header">
                <h2>Study Materials 📖</h2>
                <button class="refresh-btn" onclick="refreshNotes()">
                    <span>🔄</span>
                </button>
            </div>
            <div class="cards-container" id="notesCards"></div>
            <div class="empty-state" id="notesEmpty" style="display: none;">
                <div class="empty-icon">📖</div>
                <h3>No Notes Available</h3>
                <p>Check with your teacher</p>
            </div>
        </section>

        <!-- Timetable Section -->
        <section class="content-section" id="timetable">
            <div class="section-header">
                <h2>Class Schedule ⏰</h2>
                <div class="date-display" id="currentDate"></div>
            </div>
            <div class="timetable-container" id="timetableDisplay">
                <div class="loading-spinner">
                    <div class="spinner"></div>
                </div>
            </div>
        </section>

        <!-- Results Section -->
        <section class="content-section" id="results">
            <div class="section-header">
                <h2>Your Performance 📊</h2>
                <button class="view-all-btn" onclick="viewAllResults()">
                    View All
                </button>
            </div>
            <div class="results-container" id="resultsDisplay">
                <div class="loading-spinner">
                    <div class="spinner"></div>
                </div>
            </div>
        </section>
    </main>

    <!-- Floating Action Button -->
    <button class="fab-main" onclick="showAddOptions()">
        <span>➕</span>
    </button>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <button class="action-btn" onclick="addReminder()">
            <span>⏰</span>
            Remind
        </button>
        <button class="action-btn" onclick="shareProgress()">
            <span>📤</span>
            Share
        </button>
        <button class="action-btn" onclick="contactTeacher()">
            <span>👨‍🏫</span>
            Help
        </button>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <button class="nav-item active" data-section="homework">
            <span class="nav-icon">📝</span>
            <span class="nav-text">Homework</span>
        </button>
        <button class="nav-item" data-section="notes">
            <span class="nav-icon">📖</span>
            <span class="nav-text">Notes</span>
        </button>
        <button class="nav-item" data-section="timetable">
            <span class="nav-icon">⏰</span>
            <span class="nav-text">Schedule</span>
        </button>
        <button class="nav-item" data-section="results">
            <span class="nav-icon">📊</span>
            <span class="nav-text">Results</span>
        </button>
    </nav>

    <!-- Footer -->
    <footer class="app-footer">
        <div class="footer-content">
            <p>&copy; 2025 Springfield India School System</p>
            <p>Made with ❤️ for Indian Students</p>
            <div class="footer-links">
                <a href="#" onclick="showPrivacy()">Privacy</a>
                <a href="#" onclick="showTerms()">Terms</a>
                <a href="#" onclick="showHelp()">Help</a>
                <a href="#" onclick="showAbout()">About</a>
            </div>
        </div>
    </footer>

    <script>
        // Professional Dashboard Manager
        class ProfessionalDashboard {
            constructor() {
                this.user = JSON.parse(localStorage.getItem('currentUser'));
                if (!this.user) {
                    window.location.href = 'index.html';
                    return;
                }
                
                this.init();
            }

            init() {
                this.setupUI();
                this.setupNavigation();
                this.loadAllData();
                this.startClock();
                this.setupInteractions();
            }

            setupUI() {
                // Set welcome message
                document.getElementById('welcomeText').textContent = `Hi, ${this.user.name}`;
                document.getElementById('classText').textContent = `Class ${this.user.class}`;
                
                // Show current date
                document.getElementById('currentDate').textContent = new Date().toLocaleDateString('en-IN', {
                    weekday: 'long',
                    day: 'numeric',
                    month: 'long'
                });

                // Update status bar
                this.updateStatusBar();
            }

            setupNavigation() {
                const navItems = document.querySelectorAll('.nav-item');
                const sections = document.querySelectorAll('.content-section');

                navItems.forEach(item => {
                    item.addEventListener('click', () => {
                        const section = item.dataset.section;
                        
                        // Update active states
                        navItems.forEach(i => i.classList.remove('active'));
                        sections.forEach(s => s.style.display = 'none');
                        
                        item.classList.add('active');
                        document.getElementById(section).style.display = 'block';
                        
                        // Load section data
                        this.loadSectionData(section);
                    });
                });

                // Show first section
                this.loadSectionData('homework');
            }

            loadAllData() {
                this.updateStats();
                this.loadSectionData('homework');
                this.loadSectionData('notes');
                this.loadSectionData('timetable');
                this.loadSectionData('results');
            }

            loadSectionData(section) {
                switch(section) {
                    case 'homework':
                        this.loadHomework();
                        break;
                    case 'notes':
                        this.loadNotes();
                        break;
                    case 'timetable':
                        this.loadTimetable();
                        break;
                    case 'results':
                        this.loadResults();
                        break;
                }
            }

            loadHomework() {
                const homework = JSON.parse(localStorage.getItem('homework')) || [];
                const filtered = homework.filter(h => h.class === this.user.class);
                const container = document.getElementById('homeworkCards');
                const empty = document.getElementById('homeworkEmpty');

                if (filtered.length === 0) {
                    container.style.display = 'none';
                    empty.style.display = 'block';
                    return;
                }

                container.style.display = 'grid';
                empty.style.display = 'none';
                
                container.innerHTML = '';
                filtered.slice(0, 3).forEach(hw => {
                    container.appendChild(this.createHomeworkCard(hw));
                });
            }

            createHomeworkCard(hw) {
                const card = document.createElement('div');
                card.className = 'modern-card';
                const daysLeft = Math.ceil((new Date(hw.dueDate) - new Date()) / (1000 * 60 * 60 * 24));
                
                card.innerHTML = `
                    <div class="card-header">
                        <span class="subject-tag">${hw.subject}</span>
                        <span class="due-indicator ${daysLeft <= 1 ? 'urgent' : ''}">${daysLeft}d left</span>
                    </div>
                    <p class="card-content">${hw.description}</p>
                    <div class="card-footer">
                        <span class="due-date">Due: ${new Date(hw.dueDate).toLocaleDateString()}</span>
                        <button class="card-action" onclick="markDone('${hw.id}')">✅</button>
                    </div>
                `;
                return card;
            }

            loadNotes() {
                const notes = JSON.parse(localStorage.getItem('notes')) || [];
                const filtered = notes.filter(n => n.class === this.user.class);
                const container = document.getElementById('notesCards');
                const empty = document.getElementById('notesEmpty');

                if (filtered.length === 0) {
                    container.style.display = 'none';
                    empty.style.display = 'block';
                    return;
                }

                container.style.display = 'grid';
                empty.style.display = 'none';
                
                container.innerHTML = '';
                filtered.slice(0, 4).forEach(note => {
                    container.appendChild(this.createNoteCard(note));
                });
            }

            createNoteCard(note) {
                const card = document.createElement('div');
                card.className = 'modern-card note-card';
                
                card.innerHTML = `
                    <div class="card-header">
                        <span class="subject-tag">${note.subject}</span>
                        <span class="class-tag">Class ${note.class}</span>
                    </div>
                    <h3 class="note-title">${note.title}</h3>
                    <p class="note-preview">${note.content.substring(0, 120)}...</p>
                    <button class="read-more-btn" onclick="readNote('${note.id}')">Read More →</button>
                `;
                return card;
            }

            loadTimetable() {
                const timetables = JSON.parse(localStorage.getItem('timetables')) || [];
                const timetable = timetables.find(t => t.class === this.user.class);
                const container = document.getElementById('timetableDisplay');

                if (!timetable) {
                    container.innerHTML = '<div class="empty-state">⏰ No timetable set for your class</div>';
                    return;
                }

                const periods = [
                    { time: '9:00-9:45', subject: timetable.period1 || 'Free' },
                    { time: '9:45-10:30', subject: timetable.period2 || 'Free' },
                    { time: '10:30-11:15', subject: timetable.period3 || 'Free' },
                    { time: '11:30-12:15', subject: timetable.period4 || 'Free' },
                    { time: '12:15-1:00', subject: timetable.period5 || 'Free' },
                    { time: '1:00-1:45', subject: timetable.period6 || 'Free' }
                ];

                container.innerHTML = periods.map(p => `
                    <div class="timetable-slot">
                        <div class="time">${p.time}</div>
                        <div class="subject">${p.subject}</div>
                        ${p.subject !== 'Free' ? '<div class="status active">Active</div>' : '<div class="status free">Free</div>'}
                    </div>
                `).join('');
            }

            loadResults() {
                const results = JSON.parse(localStorage.getItem('results')) || [];
                const filtered = results.filter(r => r.class === this.user.class && r.studentName === this.user.name);
                const container = document.getElementById('resultsDisplay');

                if (filtered.length === 0) {
                    container.innerHTML = '<div class="empty-state">📊 No results posted yet</div>';
                    return;
                }

                const latest = filtered[0];
                const subjects = [
                    { name: 'Math', score: latest.math },
                    { name: 'English', score: latest.english },
                    { name: 'Science', score: latest.science },
                    { name: 'Hindi', score: latest.hindi }
                ];
                
                const total = subjects.reduce((sum, s) => sum + s.score, 0);
                const percentage = Math.round(total / 4);

                container.innerHTML = `
                    <div class="performance-card">
                        <div class="overall-score">
                            <div class="score-circle">
                                <div class="score-number">${percentage}%</div>
                                <div class="score-label">Overall</div>
                            </div>
                            <div class="score-details">
                                <h3>Latest Results</h3>
                                <p>Total: ${total}/400</p>
                                <p>Grade: ${this.getGrade(percentage)}</p>
                            </div>
                        </div>
                        <div class="subject-scores">
                            ${subjects.map(s => `
                                <div class="score-row">
                                    <span class="subject-name">${s.name}</span>
                                    <div class="score-bar">
                                        <div class="score-fill" style="width: ${s.score}%"></div>
                                    </div>
                                    <span class="score-value">${s.score}/100</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            getGrade(percentage) {
                if (percentage >= 90) return 'A+';
                if (percentage >= 80) return 'A';
                if (percentage >= 70) return 'B+';
                if (percentage >= 60) return 'B';
                if (percentage >= 50) return 'C';
                return 'D';
            }

            updateStats() {
                const homework = JSON.parse(localStorage.getItem('homework')) || [];
                const notes = JSON.parse(localStorage.getItem('notes')) || [];
                const results = JSON.parse(localStorage.getItem('results')) || [];
                
                document.getElementById('hwCount').textContent = homework.filter(h => h.class === this.user.class).length;
                document.getElementById('notesCount').textContent = notes.filter(n => n.class === this.user.class).length;
                document.getElementById('resultsCount').textContent = results.filter(r => r.class === this.user.class).length;
            }

            startClock() {
                setInterval(() => {
                    const now = new Date();
                    document.getElementById('statusTime').textContent = now.toLocaleTimeString('en-IN', {
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                }, 1000);
            }

            setupInteractions() {
                // Add touch feedback
                document.querySelectorAll('button').forEach(btn => {
                    btn.addEventListener('touchstart', () => btn.style.transform = 'scale(0.95)');
                    btn.addEventListener('touchend', () => btn.style.transform = '');
                });
            }
        }

        // Global functions
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('currentUser');
                window.location.href = 'index.html';
            }
        }

        function refreshHomework() {
            const btn = event.target;
            btn.style.transform = 'rotate(360deg)';
            setTimeout(() => btn.style.transform = '', 500);
            dashboard.loadHomework();
        }

        function refreshNotes() {
            const btn = event.target;
            btn.style.transform = 'rotate(360deg)';
            setTimeout(() => btn.style.transform = '', 500);
            dashboard.loadNotes();
        }

        function showNotifications() {
            alert('🔔 Notifications panel coming soon!');
        }

        function showProfile() {
            alert('👤 Profile page coming soon!');
        }

        function showAddOptions() {
            alert('➕ Add options: Homework, Notes, Reminder');
        }

        function addReminder() {
            alert('⏰ Reminder feature coming soon!');
        }

        function shareProgress() {
            if (navigator.share) {
                navigator.share({
                    title: 'Springfield India Dashboard',
                    text: `Check out my progress at Springfield India!`,
                    url: window.location.href
                });
            } else {
                alert('🔗 Share functionality copied to clipboard!');
            }
        }

        function contactTeacher() {
            alert('📧 Contact: teacher@springfieldindia.edu');
        }

        function viewAllResults() {
            alert('📊 Full results page coming soon!');
        }

        function markDone(id) {
            alert('✅ Great job! Homework marked as completed.');
        }

        function readNote(id) {
            alert('📖 Full note content will open in detail view.');
        }

        function showPrivacy() {
            alert('🔒 Privacy: Your data is encrypted and never shared.');
        }

        function showTerms() {
            alert('📋 Terms: Use responsibly and respect others.');
        }

        function showHelp() {
            alert('❓ Help: Contact support@springfieldindia.edu or call +91-123-456-7890');
        }

        function showAbout() {
            alert('🏫 About: Springfield India - Empowering students since 2025');
        }

        // Initialize dashboard
        const dashboard = new ProfessionalDashboard();
    </script>
</body>
</html>
